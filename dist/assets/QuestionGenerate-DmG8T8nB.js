var e=Object.defineProperty,l=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(l,n,a)=>n in l?e(l,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[n]=a,i=(e,l)=>{for(var n in l||(l={}))t.call(l,n)&&o(e,n,l[n]);if(a)for(var n of a(l))s.call(l,n)&&o(e,n,l[n]);return e},u=(e,l,n)=>new Promise((a,t)=>{var s=e=>{try{i(n.next(e))}catch(l){t(l)}},o=e=>{try{i(n.throw(e))}catch(l){t(l)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,o);i((n=n.apply(e,l)).next())});/* empty css             *//* empty css                    *//* empty css                          *//* empty css                       *//* empty css                   *//* empty css                    *//* empty css                *//* empty css                 *//* empty css                  *//* empty css                        *//* empty css                  *//* empty css                *//* empty css                     *//* empty css               *//* empty css                  *//* empty css                  */import{y as r,r as c,c as d,h as p,z as v,A as m,B as f,L as g,P as y,R as h,J as b,O as w,Q as _,a5 as k,E as x,I as V,u as q,W as C,n as I,j as S,aB as A}from"./vue-vendor-BRizdQXW.js";import{C as $,e as j,h as E,E as O,c as N,d as U,y as T,B as J,s as P,P as M,Q as D,b as F,H as z,Z as Q,_ as L,$ as B,a0 as G,f as R,a1 as K,R as H,a2 as W,K as Y,a3 as X,I as Z,p as ee,L as le,D as ne,t as ae,a4 as te,a5 as se,a6 as oe,a7 as ie,U as ue,V as re,W as ce}from"./element-plus-1qB5igSe.js";import{c as de,u as pe}from"./course-Ba9mJaVD.js";import{Q as ve,a as me}from"./storage-B26rRKbu.js";import{Q as fe}from"./questionExporter-BfuXNsZR.js";import{useQuestionStore as ge}from"./question-B2DBmUiV.js";import{_ as ye}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-BKrBH71_.js";class he{constructor(){var e,l,n;e=this,l="kimiAPI",n=de(),o(e,"symbol"!=typeof l?l+"":l,n)}generateQuestionsStream(e,l,n,a,t){return u(this,null,function*(){try{let o="";if(e&&""!==e.trim())try{o=yield this.kimiAPI.getFileContent(e)}catch(s){console.warn("获取文件内容失败，将使用默认内容:",s),o=this.getDefaultContent(l)}else o=this.getDefaultContent(l);const i=n.reduce((e,l)=>e+l.count,0),u=n.map(e=>`${this.getTypeLabel(e.type)} ${e.count}道`).join("、"),r=this.getLanguagePrompt(a.language||"zh-CN"),c=`\n基于上传的文档内容，为章节"${l}"生成${i}道题目。\n\n文档内容：\n${o.substring(0,6e3)} ${o.length>6e3?"...(内容过长，已截取前6000字符)":""}\n\n题目要求：\n${u}\n\n${r}\n\n请按照以下JSON格式生成题目：\n{\n  "questions": [\n    {\n      "type": "single|multiple|judge|fill|essay",\n      "content": "题目内容",\n      "options": ["选项A", "选项B", "选项C", "选项D"],\n      "answer": "正确答案",\n      "explanation": "详细解析",\n      "difficulty": "${a.difficulty||"medium"}"\n    }\n  ]\n}\n\n要求：\n1. 严格按照JSON格式输出\n2. 题目内容要清晰明确\n3. 答案要准确，基于文档内容\n4. 解析要详细，帮助学习者理解\n5. 判断题答案只能是"正确"或"错误"\n6. 填空题用___表示填空位置\n`;let d="";return yield this.kimiAPI.chatStream({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手。请严格按照JSON格式返回结果，不要添加任何markdown标记。"},{role:"user",content:c}],temperature:.3},e=>{d+=e,t(d,!1)}),t(d,!0),this.parseQuestionsFromJson(d)}catch(s){throw console.error("流式生成题目失败:",s),s}})}generateQuestions(e,l,n=5,a){return u(this,null,function*(){var t,s;try{const u=yield this.kimiAPI.getFileContent(e),r=(null==(t=null==a?void 0:a.types)?void 0:t.join("、"))||"单选题、多选题、判断题、填空题",c=(null==(s=null==a?void 0:a.difficulties)?void 0:s.join("、"))||"简单、中等、困难",d=`\n基于上传的文档内容，为章节"${l}"生成${n}道题目。\n\n文档内容：\n${u.substring(0,6e3)} ${u.length>6e3?"...(内容过长，已截取前6000字符)":""}\n\n请按照以下JSON格式生成题目：\n{\n  "questions": [\n    {\n      "type": "single|multiple|judge|fill|essay",\n      "content": "题目内容",\n      "options": ["选项A", "选项B", "选项C", "选项D"],\n      "answer": "正确答案",\n      "explanation": "详细解析",\n      "difficulty": "easy|medium|hard"\n    }\n  ]\n}\n\n要求：\n1. 题目类型要多样化，包括：${r}\n2. 难度要适中，包括：${c}\n3. 答案要准确，基于文档内容\n4. 解析要详细，帮助学习者理解\n5. 题目内容要清晰明确\n6. 选项要合理，避免明显错误\n7. 判断题答案只能是"正确"或"错误"\n8. 填空题要明确填空位置，用___表示\n9. 题目要基于文档实际内容，不能虚构\n10. 每道题都要有明确的答案和解析\n`,p=(yield this.kimiAPI.chat({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。你会为用户提供安全，有帮助，准确的回答。请严格按照JSON格式返回结果。"},{role:"user",content:d}],temperature:.3})).choices[0].message.content;try{let e;try{e=JSON.parse(p)}catch(o){const l=p.match(/\{[\s\S]*\}/);if(!l)throw new Error("无法解析AI返回的题目");e=JSON.parse(l[0])}if(!e.questions||!Array.isArray(e.questions))throw new Error("AI返回的题目格式不正确");const l=e.questions.filter(e=>e.type&&e.content&&e.answer&&e.explanation&&e.difficulty);if(0===l.length)throw new Error("没有生成有效的题目");return l}catch(i){return console.error("解析AI生成题目失败:",i),console.error("AI返回内容:",p),[{type:me.SINGLE,content:"请根据文档内容回答相关问题。",options:["选项A","选项B","选项C","选项D"],answer:"选项A",explanation:"请参考文档内容进行答题。",difficulty:ve.MEDIUM}]}}catch(i){throw console.error("生成题目失败:",i),new Error(`生成题目失败: ${i instanceof Error?i.message:"未知错误"}`)}})}generateQuestionsByType(e,a,t,s=3){return u(this,null,function*(){try{const d=yield this.kimiAPI.getFileContent(e);let p="";switch(t){case"single":p="单选题（每题4个选项，只有一个正确答案）";break;case"multiple":p="多选题（每题4个选项，可能有多个正确答案）";break;case"judge":p='判断题（只有"正确"或"错误"两个选项）';break;case"fill":p="填空题（在空白处填入正确答案，用___表示填空位置）";break;case"essay":p="简答题（需要简要回答，答案要简洁明了）"}const v=`\n基于上传的文档内容，为章节"${a}"生成${s}道${p}。\n\n文档内容：\n${d.substring(0,6e3)} ${d.length>6e3?"...(内容过长，已截取前6000字符)":""}\n\n请按照以下JSON格式生成题目：\n{\n  "questions": [\n    {\n      "type": "${t}",\n      "content": "题目内容",\n      ${"judge"!==t&&"essay"!==t?'"options": ["选项A", "选项B", "选项C", "选项D"],':""}\n      "answer": "正确答案",\n      "explanation": "详细解析",\n      "difficulty": "easy|medium|hard"\n    }\n  ]\n}\n\n要求：\n1. 题目类型必须是：${t}\n2. 题目内容要清晰明确\n3. 答案要准确，基于文档内容\n4. 解析要详细，帮助学习者理解\n5. 难度要适中\n6. 题目要基于文档实际内容，不能虚构\n7. ${"judge"===t?'判断题答案只能是"正确"或"错误"':""}\n8. ${"fill"===t?"填空题用___表示填空位置":""}\n`,m=(yield this.kimiAPI.chat({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。你会为用户提供安全，有帮助，准确的回答。请严格按照JSON格式返回结果。"},{role:"user",content:v}],temperature:.3})).choices[0].message.content;try{let e;try{e=JSON.parse(m)}catch(r){const l=m.match(/\{[\s\S]*\}/);if(!l)throw new Error("无法解析AI返回的题目");e=JSON.parse(l[0])}if(!e.questions||!Array.isArray(e.questions))throw new Error("AI返回的题目格式不正确");const l=e.questions.filter(e=>e.type===t&&e.content&&e.answer&&e.explanation&&e.difficulty);if(0===l.length)throw new Error("没有生成有效的题目");return l}catch(c){return console.error("解析AI生成题目失败:",c),console.error("AI返回内容:",m),[(o=i({type:t,content:"请根据文档内容回答相关问题。"},"judge"!==t&&"essay"!==t?{options:["选项A","选项B","选项C","选项D"]}:{}),u={answer:"judge"===t?"正确":"请参考文档内容",explanation:"请参考文档内容进行答题。",difficulty:ve.MEDIUM},l(o,n(u)))]}}catch(c){throw console.error("生成题目失败:",c),new Error(`生成题目失败: ${c instanceof Error?c.message:"未知错误"}`)}var o,u})}optimizeQuestion(e,l,n){return u(this,null,function*(){try{const s=yield this.kimiAPI.getFileContent(e),o=`\n基于以下文档内容和题目，请优化这道题目：\n\n文档内容：\n${s.substring(0,4e3)} ${s.length>4e3?"...(内容过长，已截取前4000字符)":""}\n\n当前题目：\n${JSON.stringify(l,null,2)}\n\n${n?`用户反馈：${n}`:""}\n\n第二个问题：请按照以下JSON格式返回优化后的题目：\n{\n  "type": "题目类型",\n  "content": "题目内容",\n  "options": ["选项A", "选项B", "选项C", "选项D"],\n  "answer": "正确答案",\n  "explanation": "详细解析",\n  "difficulty": "难度级别"\n}\n\n优化要求：\n1. 保持题目类型不变\n2. 根据用户反馈进行相应调整\n3. 确保题目内容与文档高度相关\n4. 答案要准确，解析要详细\n5. 题目表述要清晰明确\n`,i=(yield this.kimiAPI.chat({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。你会为用户提供安全，有帮助，准确的回答。请严格按照JSON格式返回结果。"},{role:"user",content:o}],temperature:.3})).choices[0].message.content;try{let e;try{e=JSON.parse(i)}catch(a){const l=i.match(/\{[\s\S]*\}/);if(!l)throw new Error("无法解析AI返回的优化题目");e=JSON.parse(l[0])}if(!e.type||!e.content||!e.answer)throw new Error("AI返回的优化题目格式不正确");return e}catch(t){return console.error("解析AI优化题目失败:",t),console.error("AI返回内容:",i),l}}catch(t){throw console.error("优化题目失败:",t),new Error(`优化题目失败: ${t instanceof Error?t.message:"未知错误"}`)}})}validateQuestionAnswer(e,l,n){return u(this,null,function*(){try{const s=yield this.kimiAPI.getFileContent(e),o=`\n基于以下文档内容，请验证用户答案是否正确：\n\n文档内容：\n${s.substring(0,4e3)} ${s.length>4e3?"...(内容过长，已截取前4000字符)":""}\n\n题目：${l.content}\n正确答案：${l.answer}\n用户答案：${n}\n\n请按照以下JSON格式返回验证结果：\n{\n  "isCorrect": true|false,\n  "explanation": "详细解析",\n  "correctAnswer": "正确答案"\n}\n\n要求：\n1. 准确判断用户答案是否正确\n2. 提供详细的解析说明\n3. 给出正确答案\n4. 解析要基于文档内容\n`,i=(yield this.kimiAPI.chat({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。你会为用户提供安全，有帮助，准确的回答。请严格按照JSON格式返回结果。"},{role:"user",content:o}],temperature:.1})).choices[0].message.content;try{let e;try{e=JSON.parse(i)}catch(a){const l=i.match(/\{[\s\S]*\}/);if(!l)throw new Error("无法解析AI返回的验证结果");e=JSON.parse(l[0])}return e}catch(t){console.error("解析AI验证结果失败:",t),console.error("AI返回内容:",i);return{isCorrect:n===l.answer,explanation:l.explanation,correctAnswer:l.answer}}}catch(t){throw console.error("验证题目答案失败:",t),new Error(`验证题目答案失败: ${t instanceof Error?t.message:"未知错误"}`)}})}generateQuestionsFromFile(e,l,n=5,a){return u(this,null,function*(){var t,s;try{yield this.kimiAPI.uploadFile(e);const u=(null==(t=null==a?void 0:a.types)?void 0:t.join("、"))||"单选题、多选题、判断题、填空题",r=(null==(s=null==a?void 0:a.difficulties)?void 0:s.join("、"))||"简单、中等、困难",c=`\n基于上传的文档内容，为主题"${l}"生成${n}道题目。\n\n请按照以下JSON格式生成题目：\n{\n  "questions": [\n    {\n      "type": "single|multiple|judge|fill|essay",\n      "content": "题目内容",\n      "options": ["选项A", "选项B", "选项C", "选项D"],\n      "answer": "正确答案",\n      "explanation": "详细解析",\n      "difficulty": "easy|medium|hard"\n    }\n  ]\n}\n\n要求：\n1. 题目类型要多样化，包括：${u}\n2. 难度要适中，包括：${r}\n3. 答案要准确，基于文档内容\n4. 解析要详细，帮助学习者理解\n5. 题目内容要清晰明确\n6. 选项要合理，避免明显错误\n7. 判断题答案只能是"正确"或"错误"\n8. 填空题要明确填空位置，用___表示\n9. 题目要基于文档实际内容，不能虚构\n10. 每道题都要有明确的答案和解析\n`,d=(yield this.kimiAPI.chat({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。你会为用户提供安全，有帮助，准确的回答。请严格按照JSON格式返回结果。"},{role:"user",content:c}],temperature:.3})).choices[0].message.content;try{let e;try{e=JSON.parse(d)}catch(o){const l=d.match(/\{[\s\S]*\}/);if(!l)throw new Error("无法解析AI返回的题目");e=JSON.parse(l[0])}if(!e.questions||!Array.isArray(e.questions))throw new Error("AI返回的题目格式不正确");const l=e.questions.filter(e=>e.type&&e.content&&e.answer&&e.explanation&&e.difficulty);if(0===l.length)throw new Error("没有生成有效的题目");return l}catch(i){return console.error("解析AI生成题目失败:",i),console.error("AI返回内容:",d),[{type:me.SINGLE,content:"请根据文档内容回答相关问题。",options:["选项A","选项B","选项C","选项D"],answer:"选项A",explanation:"请参考文档内容进行答题。",difficulty:ve.MEDIUM}]}}catch(i){throw console.error("生成题目失败:",i),new Error(`生成题目失败: ${i instanceof Error?i.message:"未知错误"}`)}})}generateQuestionsFromText(e,l,n=5,a){return u(this,null,function*(){var t,s;try{const u=(null==(t=null==a?void 0:a.types)?void 0:t.join("、"))||"单选题、多选题、判断题、填空题",r=(null==(s=null==a?void 0:a.difficulties)?void 0:s.join("、"))||"简单、中等、困难",c=`\n基于以下文本内容，为主题"${l}"生成${n}道题目。\n\n文本内容：\n${e.substring(0,6e3)} ${e.length>6e3?"...(内容过长，已截取前6000字符)":""}\n\n请按照以下JSON格式生成题目：\n{\n  "questions": [\n    {\n      "type": "single|multiple|judge|fill|essay",\n      "content": "题目内容",\n      "options": ["选项A", "选项B", "选项C", "选项D"],\n      "answer": "正确答案",\n      "explanation": "详细解析",\n      "difficulty": "easy|medium|hard"\n    }\n  ]\n}\n\n要求：\n1. 题目类型要多样化，包括：${u}\n2. 难度要适中，包括：${r}\n3. 答案要准确，基于文本内容\n4. 解析要详细，帮助学习者理解\n5. 题目内容要清晰明确\n6. 选项要合理，避免明显错误\n7. 判断题答案只能是"正确"或"错误"\n8. 填空题要明确填空位置，用___表示\n9. 题目要基于文本实际内容，不能虚构\n10. 每道题都要有明确的答案和解析\n`,d=(yield this.kimiAPI.chat({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。你会为用户提供安全，有帮助，准确的回答。请严格按照JSON格式返回结果。"},{role:"user",content:c}],temperature:.3})).choices[0].message.content;try{let e;try{e=JSON.parse(d)}catch(o){const l=d.match(/\{[\s\S]*\}/);if(!l)throw new Error("无法解析AI返回的题目");e=JSON.parse(l[0])}if(!e.questions||!Array.isArray(e.questions))throw new Error("AI返回的题目格式不正确");const l=e.questions.filter(e=>e.type&&e.content&&e.answer&&e.explanation&&e.difficulty);if(0===l.length)throw new Error("没有生成有效的题目");return l}catch(i){return console.error("解析AI生成题目失败:",i),console.error("AI返回内容:",d),[{type:me.SINGLE,content:"请根据文本内容回答相关问题。",options:["选项A","选项B","选项C","选项D"],answer:"选项A",explanation:"请参考文本内容进行答题。",difficulty:ve.MEDIUM}]}}catch(i){throw console.error("生成题目失败:",i),new Error(`生成题目失败: ${i instanceof Error?i.message:"未知错误"}`)}})}generateQuestionsFromFileStream(e,l,n,a,t){return u(this,null,function*(){try{yield this.kimiAPI.uploadFile(e);const s=n.reduce((e,l)=>e+l.count,0),o=n.map(e=>`${this.getTypeLabel(e.type)} ${e.count}道`).join("、"),i=this.getLanguagePrompt(a.language||"zh-CN"),u=`\n基于上传的文件内容，为主题"${l}"生成${s}道题目。\n\n题目要求：\n${o}\n\n${i}\n\n请按照以下JSON格式生成题目：\n{\n  "questions": [\n    {\n      "type": "single|multiple|judge|fill|essay",\n      "content": "题目内容",\n      "options": ["选项A", "选项B", "选项C", "选项D"],\n      "answer": "正确答案",\n      "explanation": "详细解析",\n      "difficulty": "${a.difficulty||"medium"}"\n    }\n  ]\n}\n\n要求：\n1. 严格按照JSON格式输出\n2. 题目内容要清晰明确\n3. 答案要准确，基于文件内容\n4. 解析要详细，帮助学习者理解\n5. 判断题答案只能是"正确"或"错误"\n6. 填空题用___表示填空位置\n7. 直接输出JSON体，不要输出其他多余的内容\n`;let r="";return yield this.kimiAPI.chatStream({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手。请严格按照JSON格式返回结果，不要添加任何markdown标记。"},{role:"user",content:u}],temperature:.3},e=>{r+=e,t(r,!1)}),t(r,!0),this.parseQuestionsFromJson(r)}catch(s){throw console.error("流式生成题目失败:",s),s}})}generateQuestionsFromTextStream(e,l,n,a,t){return u(this,null,function*(){try{const s=n.reduce((e,l)=>e+l.count,0),o=n.map(e=>`${this.getTypeLabel(e.type)} ${e.count}道`).join("、"),i=this.getLanguagePrompt(a.language||"zh-CN"),u=`\n基于以下内容，为主题"${l}"生成${s}道题目。\n\n内容：\n${e.substring(0,6e3)} ${e.length>6e3?"...(内容过长，已截取前6000字符)":""}\n\n题目要求：\n${o}\n\n${i}\n\n请按照以下JSON格式生成题目：\n{\n  "questions": [\n    {\n      "type": "single|multiple|judge|fill|essay",\n      "content": "题目内容",\n      "options": ["选项A", "选项B", "选项C", "选项D"],\n      "answer": "正确答案",\n      "explanation": "详细解析",\n      "difficulty": "${a.difficulty||"medium"}"\n    }\n  ]\n}\n\n要求：\n1. 严格按照JSON格式输出\n2. 题目内容要清晰明确\n3. 答案要准确，基于提供的内容\n4. 解析要详细，帮助学习者理解\n5. 判断题答案只能是"正确"或"错误"\n6. 填空题用___表示填空位置\n`;let r="";return yield this.kimiAPI.chatStream({model:"moonshot-v1-128k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手。请严格按照JSON格式返回结果，不要添加任何markdown标记。"},{role:"user",content:u}],temperature:.3},e=>{r+=e,t(r,!1)}),t(r,!0),this.parseQuestionsFromJson(r)}catch(s){throw console.error("流式生成题目失败:",s),s}})}getTypeLabel(e){return{single:"单选题",multiple:"多选题",judge:"判断题",fill:"填空题",essay:"简答题"}[e]||e}getLanguagePrompt(e){const l={"zh-CN":"请使用简体中文生成题目内容、选项、答案和解析。","zh-TW":"請使用繁體中文生成題目內容、選項、答案和解析。",en:"Please generate questions, options, answers, and explanations in English."};return l[e]||l["zh-CN"]}parseQuestionsFromJson(e){let l=e.trim();l.startsWith("```json")?l=l.replace(/^```json\s*/,"").replace(/\s*```$/,""):l.startsWith("```")&&(l=l.replace(/^```\s*/,"").replace(/\s*```$/,""));const n=JSON.parse(l);if(!n.questions||!Array.isArray(n.questions))throw new Error("AI返回的题目格式不正确");return n.questions.filter(e=>e.type&&e.content&&e.answer&&e.explanation&&e.difficulty)}getDefaultContent(e){return{"Vue.js 简介与安装":"\nVue.js 是一个用于构建用户界面的渐进式框架。Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。\n\nVue.js 的特点：\n1. 渐进式框架：可以逐步采用，不需要重写整个项目\n2. 响应式数据绑定：数据变化时自动更新视图\n3. 组件化开发：可复用的组件提高开发效率\n4. 虚拟DOM：提高渲染性能\n5. 指令系统：简化DOM操作\n\n安装方式：\n- CDN引入\n- NPM安装\n- 脚手架工具Vue CLI\n- Vite构建工具\n\nVue实例是Vue应用的根实例，通过new Vue()创建。每个Vue实例都有data、methods、computed等选项。\n      ","模板语法与指令":"\nVue.js 使用基于 HTML 的模板语法，允许开发者声明式地将 DOM 绑定至底层 Vue 实例的数据。\n\n模板语法包括：\n1. 插值：{{ }} 双大括号语法\n2. 指令：v- 前缀的特殊属性\n3. 表达式：在模板中可以使用JavaScript表达式\n\n常用指令：\n- v-if / v-else / v-show：条件渲染\n- v-for：列表渲染\n- v-model：双向数据绑定\n- v-bind：属性绑定\n- v-on：事件监听\n- v-text / v-html：文本内容绑定\n\n计算属性computed用于处理复杂逻辑，具有缓存特性。侦听器watch用于响应数据变化。\n      ","组件化开发":"\n组件是Vue.js最强大的特性之一。组件可以扩展HTML元素，封装可重用的代码。\n\n组件的特点：\n1. 可复用性：一次定义，多处使用\n2. 封装性：内部逻辑和样式独立\n3. 可组合性：组件可以嵌套使用\n4. 数据隔离：每个组件实例有独立的作用域\n\n组件注册方式：\n- 全局注册：Vue.component()\n- 局部注册：在components选项中注册\n\n组件通信：\n- 父传子：props\n- 子传父：$emit\n- 兄弟组件：事件总线或Vuex\n- 跨级组件：provide/inject\n\n组件生命周期：\n- created：实例创建后\n- mounted：DOM挂载后\n- updated：数据更新后\n- destroyed：实例销毁前\n      ","高级类型系统":"\nTypeScript的高级类型系统提供了强大的类型操作能力，让开发者能够创建更精确和灵活的类型定义。\n\n高级类型包括：\n1. 联合类型（Union Types）：使用 | 操作符\n2. 交叉类型（Intersection Types）：使用 & 操作符\n3. 字面量类型（Literal Types）：具体的字符串或数字值\n4. 类型别名（Type Aliases）：使用type关键字\n5. 接口（Interfaces）：定义对象结构\n6. 泛型（Generics）：类型参数化\n\n类型守卫和类型断言：\n- typeof 类型守卫\n- instanceof 类型守卫\n- 用户定义的类型守卫\n- 类型断言 as 语法\n\n映射类型和条件类型：\n- Partial<T>：所有属性变为可选\n- Required<T>：所有属性变为必需\n- Pick<T, K>：选择特定属性\n- Omit<T, K>：排除特定属性\n      ","泛型编程":"\n泛型是TypeScript中最重要的特性之一，它允许在定义函数、接口或类时不预先指定具体的类型，而在使用时再指定类型。\n\n泛型的基本概念：\n1. 类型参数：使用尖括号<>定义\n2. 泛型约束：使用extends关键字\n3. 默认类型参数：为泛型参数提供默认值\n4. 泛型接口：接口也可以使用泛型\n5. 泛型类：类也可以使用泛型\n\n泛型函数示例：\nfunction identity<T>(arg: T): T {\n  return arg;\n}\n\n泛型接口示例：\ninterface GenericInterface<T> {\n  value: T;\n  getValue(): T;\n}\n\n泛型约束示例：\ninterface Lengthwise {\n  length: number;\n}\n\nfunction loggingIdentity<T extends Lengthwise>(arg: T): T {\n  console.log(arg.length);\n  return arg;\n}\n      ","装饰器与元编程":"\n装饰器是TypeScript中一个强大的特性，它允许在类声明、方法、属性或参数上添加元数据。\n\n装饰器的基本概念：\n1. 装饰器工厂：返回装饰器函数的函数\n2. 装饰器组合：多个装饰器可以组合使用\n3. 装饰器执行顺序：从外到内，从下到上\n\n装饰器类型：\n- 类装饰器：应用于类构造函数\n- 方法装饰器：应用于方法\n- 属性装饰器：应用于属性\n- 参数装饰器：应用于参数\n\n元编程概念：\n- 反射：在运行时检查和修改程序结构\n- 元数据：描述其他数据的数据\n- 注解：为代码添加元数据信息\n\n实际应用：\n- 依赖注入\n- 路由配置\n- 验证规则\n- 日志记录\n- 性能监控\n      "}[e]||`\n基于章节"${e}"的内容生成题目。\n\n这是一个示例课程章节，包含相关的知识点和概念。请根据章节主题生成相应的练习题，包括：\n\n1. 基础概念理解\n2. 重要知识点掌握\n3. 实际应用能力\n4. 问题解决能力\n\n题目应该覆盖章节的核心内容，难度适中，能够有效检验学习效果。\n    `}}const be={class:"question-preview"},we={class:"preview-header"},_e={class:"preview-stats"},ke={class:"score"},xe={key:0,class:"question-container"},Ve={class:"question-header"},qe={class:"question-meta"},Ce={class:"question-content"},Ie={class:"question-text"},Se={key:0,class:"question-options"},Ae=["onClick"],$e={class:"option-label"},je={class:"option-text"},Ee={key:1,class:"judge-options"},Oe={key:2,class:"fill-input"},Ne={key:3,class:"essay-input"},Ue={key:0,class:"answer-section"},Te={class:"correct-answer"},Je={class:"explanation"},Pe={class:"action-buttons"},Me={key:1,class:"test-completed"},De={class:"completion-header"},Fe={class:"final-score"},ze={class:"score-number"},Qe={class:"score-total"},Le={class:"score-percentage"},Be={class:"completion-actions"},Ge=ye(r({__name:"QuestionPreview",props:{questions:{}},emits:["close"],setup(e,{emit:l}){const n=e,a=c(0),t=c([]),s=c(!1),o=c(!1),i=d(()=>n.questions[a.value]),u=d(()=>t.value.filter((e,l)=>{var a;return e===(null==(a=n.questions[l])?void 0:a.answer)}).length);p(a,()=>{s.value=!1});const r=e=>{s.value||(t.value[a.value]=e)},q=()=>{t.value[a.value]?s.value=!0:O.warning("请先选择答案")},C=()=>{a.value<n.questions.length-1?a.value++:o.value=!0},I=()=>{a.value=0,t.value=[],s.value=!1,o.value=!1},S=e=>{switch(e){case"single":return"primary";case"multiple":return"success";case"judge":return"warning";case"fill":default:return"info";case"essay":return"danger"}},A=e=>{switch(e){case"single":return"单选题";case"multiple":return"多选题";case"judge":return"判断题";case"fill":return"填空题";case"essay":return"简答题";default:return"未知"}},N=e=>{switch(e){case"easy":return"success";case"medium":return"warning";case"hard":return"danger";default:return"info"}},U=e=>{switch(e){case"easy":return"简单";case"medium":return"中等";case"hard":return"困难";default:return"未知"}};return(l,n)=>{const c=$,d=j,p=E;return m(),v("div",be,[f("div",we,[n[6]||(n[6]=f("h3",null,"题目预览测试",-1)),f("div",_e,[f("span",null,"第 "+y(a.value+1)+" 题，共 "+y(e.questions.length)+" 题",1),f("span",ke,"得分："+y(u.value)+"/"+y(e.questions.length),1)])]),i.value?(m(),v("div",xe,[f("div",Ve,[f("div",qe,[h(c,{type:S(i.value.type)},{default:b(()=>[w(y(A(i.value.type)),1)]),_:1},8,["type"]),h(c,{type:N(i.value.difficulty),size:"small"},{default:b(()=>[w(y(U(i.value.difficulty)),1)]),_:1},8,["type"])])]),f("div",Ce,[f("div",Ie,y(i.value.content),1),i.value.options&&i.value.options.length>0?(m(),v("div",Se,[(m(!0),v(_,null,k(i.value.options,(e,l)=>(m(),v("div",{key:l,class:x(["option-item",{selected:t.value[a.value]===String.fromCharCode(65+l),correct:s.value&&i.value.answer===String.fromCharCode(65+l),incorrect:s.value&&t.value[a.value]===String.fromCharCode(65+l)&&i.value.answer!==String.fromCharCode(65+l)}]),onClick:e=>r(String.fromCharCode(65+l))},[f("span",$e,y(String.fromCharCode(65+l))+".",1),f("span",je,y(e),1)],10,Ae))),128))])):"judge"===i.value.type?(m(),v("div",Ee,[f("div",{class:x(["option-item",{selected:"正确"===t.value[a.value],correct:s.value&&"正确"===i.value.answer,incorrect:s.value&&"正确"===t.value[a.value]&&"正确"!==i.value.answer}]),onClick:n[0]||(n[0]=e=>r("正确"))}," 正确 ",2),f("div",{class:x(["option-item",{selected:"错误"===t.value[a.value],correct:s.value&&"错误"===i.value.answer,incorrect:s.value&&"错误"===t.value[a.value]&&"错误"!==i.value.answer}]),onClick:n[1]||(n[1]=e=>r("错误"))}," 错误 ",2)])):"fill"===i.value.type?(m(),v("div",Oe,[h(d,{modelValue:t.value[a.value],"onUpdate:modelValue":n[2]||(n[2]=e=>t.value[a.value]=e),placeholder:"请输入答案",disabled:s.value},null,8,["modelValue","disabled"])])):"essay"===i.value.type?(m(),v("div",Ne,[h(d,{modelValue:t.value[a.value],"onUpdate:modelValue":n[3]||(n[3]=e=>t.value[a.value]=e),type:"textarea",rows:4,placeholder:"请输入答案",disabled:s.value},null,8,["modelValue","disabled"])])):g("",!0)]),s.value?(m(),v("div",Ue,[f("div",Te,[n[7]||(n[7]=f("strong",null,"正确答案：",-1)),w(y(i.value.answer),1)]),f("div",Je,[n[8]||(n[8]=f("strong",null,"解析：",-1)),w(y(i.value.explanation),1)])])):g("",!0),f("div",Pe,[s.value?g("",!0):(m(),V(p,{key:0,type:"primary",onClick:q,disabled:!t.value[a.value]},{default:b(()=>[...n[9]||(n[9]=[w(" 检查答案 ",-1)])]),_:1},8,["disabled"])),s.value?(m(),V(p,{key:1,onClick:C,disabled:a.value>=e.questions.length-1},{default:b(()=>[w(y(a.value>=e.questions.length-1?"完成测试":"下一题"),1)]),_:1},8,["disabled"])):g("",!0),h(p,{onClick:I},{default:b(()=>[...n[10]||(n[10]=[w("重新开始",-1)])]),_:1}),h(p,{onClick:n[4]||(n[4]=e=>l.$emit("close"))},{default:b(()=>[...n[11]||(n[11]=[w("关闭",-1)])]),_:1})])])):g("",!0),o.value?(m(),v("div",Me,[f("div",De,[n[12]||(n[12]=f("h3",null,"测试完成！",-1)),f("div",Fe,[f("span",ze,y(u.value),1),f("span",Qe,"/ "+y(e.questions.length),1)]),f("div",Le,y(Math.round(u.value/e.questions.length*100))+"% ",1)]),f("div",Be,[h(p,{type:"primary",onClick:I},{default:b(()=>[...n[13]||(n[13]=[w("重新测试",-1)])]),_:1}),h(p,{onClick:n[5]||(n[5]=e=>l.$emit("close"))},{default:b(()=>[...n[14]||(n[14]=[w("关闭",-1)])]),_:1})])])):g("",!0)])}}}),[["__scopeId","data-v-22908078"]]),Re={class:"options-container"},Ke={class:"option-label"},He={class:"dialog-footer"},We=ye(r({__name:"QuestionEditDialog",props:{visible:{type:Boolean,default:!1},question:{default:null},isEdit:{type:Boolean,default:!1}},emits:["update:visible","save"],setup(e,{emit:l}){const n=e,a=l,t=c(),s=c(!1),o=c({type:"single",content:"",options:["","","",""],answer:"",explanation:"",difficulty:"medium"}),r={type:[{required:!0,message:"请选择题目类型",trigger:"change"}],content:[{required:!0,message:"请输入题目内容",trigger:"blur"},{min:5,message:"题目内容至少5个字符",trigger:"blur"}],answer:[{required:!0,message:"请输入正确答案",trigger:"blur"}],explanation:[{required:!0,message:"请输入详细解析",trigger:"blur"}],difficulty:[{required:!0,message:"请选择难度级别",trigger:"change"}],options:[{validator:(e,l,n)=>{if(x.value){const e=l.filter(e=>e.trim());e.length<2?n(new Error("至少需要2个选项")):e.length!==[...new Set(e)].length?n(new Error("选项不能重复")):n()}else n()},trigger:"blur"}]},x=d(()=>["single","multiple"].includes(o.value.type));p(()=>n.visible,e=>{e&&S()}),p(()=>n.question,e=>{e&&S()});const S=()=>{n.question?o.value={type:n.question.type,content:n.question.content,options:n.question.options?[...n.question.options]:["","","",""],answer:n.question.answer,explanation:n.question.explanation,difficulty:n.question.difficulty}:o.value={type:"single",content:"",options:["","","",""],answer:"",explanation:"",difficulty:"medium"}},A=e=>{"judge"===e?(o.value.options=[],o.value.answer=""):"fill"===e||"essay"===e?o.value.options=[]:["single","multiple"].includes(e)&&0===o.value.options.length&&(o.value.options=["","","",""])},$=()=>{var e;((null==(e=o.value.options)?void 0:e.length)||0)<6&&(o.value.options||(o.value.options=[]),o.value.options.push(""))},z=()=>{switch(o.value.type){case"single":case"multiple":return"请输入选项字母，如：A 或 A,B";case"judge":return'请输入"正确"或"错误"';case"fill":return"请输入填空答案";case"essay":return"请输入参考答案";default:return"请输入正确答案"}},Q=()=>u(null,null,function*(){var e;if(t.value)try{yield t.value.validate(),s.value=!0;const l=i({},o.value);x.value?l.options=(null==(e=l.options)?void 0:e.filter(e=>e.trim()))||[]:delete l.options,a("save",l),O.success(n.isEdit?"题目更新成功":"题目添加成功"),L()}catch(l){console.error("表单验证失败:",l)}finally{s.value=!1}}),L=()=>{a("update:visible",!1),I(()=>{t.value&&t.value.resetFields()})};return(l,n)=>{const a=J,i=T,u=U,c=j,d=P,p=E,I=F,S=N;return m(),V(S,{"model-value":e.visible,title:e.isEdit?"编辑题目":"添加题目",width:"800px",top:"80px","close-on-click-modal":!1,style:{top:"80px !important"},"onUpdate:modelValue":n[6]||(n[6]=e=>l.$emit("update:visible",e)),onClose:L},{footer:b(()=>[f("div",He,[h(p,{onClick:L},{default:b(()=>[...n[8]||(n[8]=[w("取消",-1)])]),_:1}),h(p,{type:"primary",onClick:Q,loading:s.value},{default:b(()=>[w(y(e.isEdit?"保存":"添加"),1)]),_:1},8,["loading"])])]),default:b(()=>[h(I,{model:o.value,rules:r,ref_key:"formRef",ref:t,"label-width":"100px",onSubmit:n[5]||(n[5]=C(()=>{},["prevent"]))},{default:b(()=>[h(u,{label:"题目类型",prop:"type"},{default:b(()=>[h(i,{modelValue:o.value.type,"onUpdate:modelValue":n[0]||(n[0]=e=>o.value.type=e),placeholder:"请选择题目类型",onChange:A},{default:b(()=>[h(a,{label:"单选题",value:"single"}),h(a,{label:"多选题",value:"multiple"}),h(a,{label:"判断题",value:"judge"}),h(a,{label:"填空题",value:"fill"}),h(a,{label:"简答题",value:"essay"})]),_:1},8,["modelValue"])]),_:1}),h(u,{label:"难度级别",prop:"difficulty"},{default:b(()=>[h(i,{modelValue:o.value.difficulty,"onUpdate:modelValue":n[1]||(n[1]=e=>o.value.difficulty=e),placeholder:"请选择难度级别"},{default:b(()=>[h(a,{label:"简单",value:"easy"}),h(a,{label:"中等",value:"medium"}),h(a,{label:"困难",value:"hard"})]),_:1},8,["modelValue"])]),_:1}),h(u,{label:"题目内容",prop:"content"},{default:b(()=>[h(c,{modelValue:o.value.content,"onUpdate:modelValue":n[2]||(n[2]=e=>o.value.content=e),type:"textarea",rows:4,placeholder:"请输入题目内容",maxlength:"1000","show-word-limit":""},null,8,["modelValue"])]),_:1}),x.value?(m(),V(u,{key:0,label:"选项设置",prop:"options"},{default:b(()=>{var e;return[f("div",Re,[(m(!0),v(_,null,k(o.value.options||[],(e,l)=>{var n;return m(),v("div",{key:l,class:"option-item"},[f("span",Ke,y(String.fromCharCode(65+l))+".",1),h(c,{modelValue:o.value.options[l],"onUpdate:modelValue":e=>o.value.options[l]=e,placeholder:`选项 ${String.fromCharCode(65+l)}`,class:"option-input"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),((null==(n=o.value.options)?void 0:n.length)||0)>2?(m(),V(p,{key:0,type:"text",size:"small",onClick:e=>(e=>{var l,n;((null==(l=o.value.options)?void 0:l.length)||0)>2&&(null==(n=o.value.options)||n.splice(e,1))})(l),class:"remove-option"},{default:b(()=>[h(d,null,{default:b(()=>[h(q(M))]),_:1})]),_:1},8,["onClick"])):g("",!0)])}),128)),((null==(e=o.value.options)?void 0:e.length)||0)<6?(m(),V(p,{key:0,type:"dashed",onClick:$,class:"add-option"},{default:b(()=>[h(d,null,{default:b(()=>[h(q(D))]),_:1}),n[7]||(n[7]=w(" 添加选项 ",-1))]),_:1})):g("",!0)])]}),_:1})):g("",!0),h(u,{label:"正确答案",prop:"answer"},{default:b(()=>[h(c,{modelValue:o.value.answer,"onUpdate:modelValue":n[3]||(n[3]=e=>o.value.answer=e),placeholder:z(),maxlength:"500","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1}),h(u,{label:"详细解析",prop:"explanation"},{default:b(()=>[h(c,{modelValue:o.value.explanation,"onUpdate:modelValue":n[4]||(n[4]=e=>o.value.explanation=e),type:"textarea",rows:3,placeholder:"请输入详细解析",maxlength:"1000","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value","title"])}}}),[["__scopeId","data-v-f427af87"]]),Ye={class:"question-generate"},Xe={class:"generate-layout"},Ze={class:"mode-selection"},el={class:"mode-content-scrollable"},ll={class:"mode-content"},nl={class:"mode-description"},al={class:"generation-settings-header"},tl={class:"settings-summary"},sl={class:"total-count"},ol={class:"top-controls"},il={class:"question-types-section"},ul={class:"question-type-list"},rl={class:"quantity-control"},cl={class:"mode-content"},dl={class:"mode-description"},pl={class:"generation-settings-header"},vl={class:"settings-summary"},ml={class:"total-count"},fl={class:"top-controls"},gl={class:"question-types-section"},yl={class:"question-type-list"},hl={class:"quantity-control"},bl={class:"mode-content"},wl={class:"mode-description"},_l={class:"generation-settings-header"},kl={class:"settings-summary"},xl={class:"total-count"},Vl={class:"top-controls"},ql={class:"question-types-section"},Cl={class:"question-type-list"},Il={class:"quantity-control"},Sl={class:"generate-actions-fixed"},Al={class:"content-area"},$l={class:"content-header"},jl={key:0,class:"empty-state"},El={key:1,class:"streaming-progress"},Ol={class:"streaming-header"},Nl={class:"header-actions"},Ul={class:"progress-text"},Tl={class:"phase-indicator"},Jl=["innerHTML"],Pl={key:2,class:"generate-progress"},Ml={class:"progress-content"},Dl={class:"progress-bar"},Fl={key:3,class:"questions-list streaming"},zl={class:"streaming-questions"},Ql={key:0,class:"question-content"},Ll={key:1,class:"question-options"},Bl={key:2,class:"question-answer"},Gl={key:3,class:"question-explanation"},Rl={key:4,class:"generating-indicator"},Kl={key:4,class:"generate-results"},Hl={class:"results-header"},Wl={class:"results-actions"},Yl={class:"questions-list"},Xl={class:"question-header"},Zl={class:"question-number"},en={class:"question-type"},ln={class:"question-difficulty"},nn={class:"question-actions"},an={class:"question-content"},tn={key:0,class:"question-options"},sn={class:"question-answer"},on={class:"question-explanation"},un=ye(r({__name:"QuestionGenerate",setup(e){const l=A(),n=pe(),a=ge(),t=c("course"),s=c([]),o=c(null),r=c(!1),p=c([]),C=c(""),I=c("info"),$=c(0),de=c(!1),ye=c(!1),be=c(null),we=c(-1),_e=c(!1),ke=c({format:"excel",include:["options","answer","explanation"]}),xe=[{value:"zh-CN",label:"简体中文"},{value:"zh-TW",label:"繁体中文"},{value:"en",label:"English"}],Ve=c([{type:me.SINGLE,label:"单选题",enabled:!1,count:1,min:1,max:20},{type:me.MULTIPLE,label:"多选题",enabled:!1,count:1,min:1,max:20},{type:me.JUDGE,label:"判断题",enabled:!1,count:1,min:1,max:20},{type:me.FILL,label:"填空题",enabled:!1,count:1,min:1,max:20},{type:me.ESSAY,label:"简答题",enabled:!1,count:1,min:1,max:20}]),qe=c({isStreaming:!1,currentPhase:"",currentQuestionIndex:-1,totalCount:0,rawOutput:"",questions:[]}),Ce=c(!1),Ie=c(),Se=c(),Ae=c(),$e=c(),je=c(),Ee=c({courseId:"",chapterId:"",language:"zh-CN",difficulty:ve.MEDIUM}),Oe=c({file:null,topic:"",language:"zh-CN",difficulty:ve.MEDIUM}),Ne=c({topic:"",content:"",language:"zh-CN",difficulty:ve.MEDIUM}),Ue={courseId:[{required:!0,message:"请选择课程",trigger:"change"}]},Te={file:[{required:!0,message:"请上传文件",trigger:"change"}],topic:[{required:!0,message:"请输入文件主题",trigger:"blur"}]},Je={topic:[{required:!0,message:"请输入课程主题",trigger:"blur"}],content:[{required:!0,message:"请输入内容描述",trigger:"blur"}]},Pe=d(()=>{const e=Ve.value.some(e=>e.enabled),l=Me.value>0;switch(t.value){case"course":return Ee.value.courseId&&e&&l;case"upload":return Oe.value.file&&Oe.value.topic&&e&&l;case"text":return Ne.value.topic&&Ne.value.content&&e&&l;default:return!1}}),Me=d(()=>Ve.value.filter(e=>e.enabled).reduce((e,l)=>e+l.count,0));S(()=>u(null,null,function*(){yield De()}));const De=()=>u(null,null,function*(){try{const e=yield n.fetchCourses();s.value=e.courses}catch(e){console.error("获取课程列表失败:",e),O.error("获取课程列表失败")}}),Fe=e=>{p.value=[]},ze=e=>{o.value=s.value.find(l=>l.id===e),Ee.value.chapterId=""},Qe=e=>{Oe.value.file=e.raw},Le=e=>{const l="application/pdf"===e.type||"text/plain"===e.type,n=e.size/1024/1024<10;return l?!!n||(O.error("文件大小不能超过 10MB!"),!1):(O.error("只能上传 PDF 或 TXT 文件!"),!1)},Be=()=>u(null,null,function*(){try{let e;switch(t.value){case"course":e=Se.value;break;case"upload":e=Ae.value;break;case"text":e=$e.value}e&&(yield e.validate()),qe.value={isStreaming:!0,currentPhase:"正在准备生成题目...",currentQuestionIndex:-1,totalCount:Me.value,rawOutput:"",questions:[]},Ce.value=!1,r.value=!0,p.value=[];const l=new he,n=Ve.value.filter(e=>e.enabled).map(e=>({type:e.type,count:e.count}));qe.value.currentPhase="正在生成题目内容...";let a=[];switch(t.value){case"course":a=yield Re(l,n);break;case"upload":a=yield Ke(l,n);break;case"text":a=yield He(l,n)}qe.value.isStreaming=!1,qe.value.currentPhase="生成完成！",p.value=a,O.success(`成功生成 ${a.length} 道题目！`)}catch(e){console.error("生成题目失败:",e),O.error("生成题目失败，请重试"),qe.value.isStreaming=!1}finally{r.value=!1}}),Re=(e,l)=>u(null,null,function*(){var n,a,t;const i=s.value.find(e=>e.id===Ee.value.courseId);if(!i)throw new Error("课程不存在");const u=Ee.value.chapterId?(null==(t=null==(a=null==(n=o.value)?void 0:n.chapters)?void 0:a.find(e=>e.id===Ee.value.chapterId))?void 0:t.title)||"":i.title;return yield e.generateQuestionsStream(i.uploadedFileId||"",u,l,{language:Ee.value.language,difficulty:Ee.value.difficulty},(e,l)=>{l&&(qe.value.isStreaming=!1),yn(e)})}),Ke=(e,l)=>u(null,null,function*(){if(!Oe.value.file)throw new Error("请先上传文件");return yield e.generateQuestionsFromFileStream(Oe.value.file,Oe.value.topic,l,{language:Oe.value.language,difficulty:Oe.value.difficulty},(e,l)=>{l&&(qe.value.isStreaming=!1),yn(e)})}),He=(e,l)=>u(null,null,function*(){return yield e.generateQuestionsFromTextStream(Ne.value.content,Ne.value.topic,l,{language:Ne.value.language,difficulty:Ne.value.difficulty},(e,l)=>{l&&(qe.value.isStreaming=!1),yn(e)})}),un=e=>{we.value>=0&&(p.value[we.value]=i({},e)),de.value=!1,O.success("题目编辑保存成功")},rn=()=>{0!==p.value.length?_e.value=!0:O.warning("暂无题目可导出")},cn=()=>u(null,null,function*(){try{const e=p.value.map((e,l)=>({id:`generated-${l}`,bankId:"",courseId:"",type:e.type,content:e.content,options:e.options,answer:e.answer,explanation:e.explanation,difficulty:e.difficulty,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),userId:"",tags:[],status:"active"})),l={format:ke.value.format,includeAnswers:ke.value.include.includes("answer"),includeExplanations:ke.value.include.includes("explanation"),includeMetadata:ke.value.include.includes("options")};switch(l.format){case"excel":yield fe.exportToExcel(e,l);break;case"word":yield fe.exportToWord(e,l);break;case"pdf":yield fe.exportToPDF(e,l);break;case"csv":yield fe.exportToCSV(e,l)}O.success("导出成功"),_e.value=!1}catch(e){console.error("导出失败:",e),O.error(e instanceof Error?e.message:"导出失败")}}),dn=()=>u(null,null,function*(){try{yield a.addQuestions(p.value),O.success("题目已保存到题库！")}catch(e){console.error("保存题目失败:",e),O.error("保存题目失败")}}),pn=()=>{ye.value=!0},vn=()=>{l.push("/questions")},mn=e=>{e.count<e.max&&e.count++},fn=e=>{e.count>e.min&&e.count--},gn=()=>{Ce.value=!Ce.value},yn=e=>{qe.value.rawOutput=(e=>e.replace(/"([^"]+)":/g,'<span class="json-key">"$1":</span>').replace(/: "([^"]+)"/g,': <span class="json-string">"$1"</span>').replace(/: (\d+)/g,': <span class="json-number">$1</span>').replace(/: (true|false)/g,': <span class="json-boolean">$1</span>').replace(/: null/g,': <span class="json-boolean">null</span>'))(e),setTimeout(()=>{Ie.value&&(Ie.value.scrollTop=Ie.value.scrollHeight)},50);try{let l=e.trim();l.startsWith("```json")?l=l.replace(/^```json\s*/,"").replace(/\s*```$/,""):l.startsWith("```")&&(l=l.replace(/^```\s*/,"").replace(/\s*```$/,""));const n=JSON.parse(l);n.questions&&Array.isArray(n.questions)&&n.questions.forEach((e,l)=>{qe.value.questions[l]||(qe.value.questions[l]={isGenerating:!0,generatingField:"content"},qe.value.currentQuestionIndex=l);const n=qe.value.questions[l];e.type&&(n.type=e.type),e.difficulty&&(n.difficulty=e.difficulty),e.content&&!n.content&&(n.content=e.content,n.generatingField="options"),e.options&&!n.options&&(n.options=e.options,n.generatingField="answer"),e.answer&&!n.answer&&(n.answer=e.answer,n.generatingField="explanation"),e.explanation&&!n.explanation&&(n.explanation=e.explanation,n.generatingField="complete",n.isGenerating=!1)})}catch(l){console.log("JSON解析失败，内容可能不完整:",l)}};return(e,l)=>{const n=P,a=J,u=T,c=U,d=F,S=R,A=E,pe=H,me=B,fe=Y,ge=j,he=L,De=z,Re=Q,Ke=ne,He=se,yn=N,hn=re,bn=ue,wn=ce;return m(),v("div",Ye,[f("div",Xe,[f("div",Ze,[h(De,{class:"mode-card"},{header:b(()=>[...l[19]||(l[19]=[f("h3",null,"选择生成方式",-1)])]),default:b(()=>[f("div",el,[h(he,{modelValue:t.value,"onUpdate:modelValue":l[11]||(l[11]=e=>t.value=e),onTabChange:Fe,direction:"vertical"},{default:b(()=>[h(me,{label:"课程生成",name:"course"},{default:b(()=>[f("div",ll,[f("div",nl,[h(n,null,{default:b(()=>[h(q(G))]),_:1}),l[20]||(l[20]=f("div",null,[f("h4",null,"基于已有课程内容生成题目"),f("p",null,"选择现有课程和章节，基于课程内容智能生成相关练习题")],-1))]),h(d,{model:Ee.value,rules:Ue,ref_key:"courseFormRef",ref:Se,"label-width":"100px",size:"small"},{default:b(()=>[h(c,{label:"选择课程",prop:"courseId"},{default:b(()=>[h(u,{modelValue:Ee.value.courseId,"onUpdate:modelValue":l[0]||(l[0]=e=>Ee.value.courseId=e),placeholder:"请选择课程",onChange:ze},{default:b(()=>[(m(!0),v(_,null,k(s.value,e=>(m(),V(a,{key:e.id,label:e.title,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o.value?(m(),V(c,{key:0,label:"选择章节",prop:"chapterId"},{default:b(()=>[h(u,{modelValue:Ee.value.chapterId,"onUpdate:modelValue":l[1]||(l[1]=e=>Ee.value.chapterId=e),placeholder:"请选择章节（可选）",clearable:""},{default:b(()=>[(m(!0),v(_,null,k(o.value.chapters,e=>(m(),V(a,{key:e.id,label:e.title,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):g("",!0)]),_:1},8,["model"]),f("div",al,[f("div",tl,[f("h4",null,[l[21]||(l[21]=w("生成设置 ",-1)),f("span",sl,"共"+y(Me.value)+"题",1)])]),f("div",ol,[h(c,{label:"语言"},{default:b(()=>[h(u,{modelValue:Ee.value.language,"onUpdate:modelValue":l[2]||(l[2]=e=>Ee.value.language=e),placeholder:"选择语言",clearable:""},{default:b(()=>[(m(),v(_,null,k(xe,e=>h(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),h(c,{label:"难度"},{default:b(()=>[h(u,{modelValue:Ee.value.difficulty,"onUpdate:modelValue":l[3]||(l[3]=e=>Ee.value.difficulty=e),placeholder:"选择难度",clearable:""},{default:b(()=>[h(a,{label:"简单",value:q(ve).EASY},null,8,["value"]),h(a,{label:"中等",value:q(ve).MEDIUM},null,8,["value"]),h(a,{label:"困难",value:q(ve).HARD},null,8,["value"])]),_:1},8,["modelValue"])]),_:1})])]),f("div",il,[l[22]||(l[22]=f("h4",null,"选择题型和数量",-1)),f("div",ul,[(m(!0),v(_,null,k(Ve.value,e=>(m(),v("div",{key:e.type,class:x(["question-type-item",{"is-enabled":e.enabled}])},[h(S,{modelValue:e.enabled,"onUpdate:modelValue":l=>e.enabled=l,label:e.label},null,8,["modelValue","onUpdate:modelValue","label"]),f("div",rl,[h(A,{icon:q(K),size:"small",circle:"",disabled:!e.enabled||e.count<=e.min,onClick:l=>fn(e)},null,8,["icon","disabled","onClick"]),h(pe,{modelValue:e.count,"onUpdate:modelValue":l=>e.count=l,min:e.min,max:e.max,disabled:!e.enabled,size:"small","controls-position":"right"},null,8,["modelValue","onUpdate:modelValue","min","max","disabled"]),h(A,{icon:q(D),size:"small",circle:"",disabled:!e.enabled||e.count>=e.max,onClick:l=>mn(e)},null,8,["icon","disabled","onClick"])])],2))),128))])])])]),_:1}),h(me,{label:"文件生成",name:"upload"},{default:b(()=>[f("div",cl,[f("div",dl,[h(n,null,{default:b(()=>[h(q(W))]),_:1}),l[23]||(l[23]=f("div",null,[f("h4",null,"基于上传文件生成题目"),f("p",null,"上传PDF、TXT等文件，基于文件内容智能生成相关练习题")],-1))]),h(d,{model:Oe.value,rules:Te,ref_key:"uploadFormRef",ref:Ae,size:"small"},{default:b(()=>[h(c,{label:"上传文件",prop:"file"},{default:b(()=>[h(fe,{ref_key:"uploadRef",ref:je,"auto-upload":!1,"on-change":Qe,"before-upload":Le,accept:".pdf,.txt",drag:""},{tip:b(()=>[...l[24]||(l[24]=[f("div",{class:"el-upload__tip"}," 只能上传 PDF/TXT 文件，且不超过 10MB ",-1)])]),default:b(()=>[h(n,{class:"el-icon--upload"},{default:b(()=>[h(q(X))]),_:1}),l[25]||(l[25]=f("div",{class:"el-upload__text"},[w(" 将文件拖到此处，或"),f("em",null,"点击上传")],-1))]),_:1},512)]),_:1}),h(c,{label:"文件主题",prop:"topic"},{default:b(()=>[h(ge,{modelValue:Oe.value.topic,"onUpdate:modelValue":l[4]||(l[4]=e=>Oe.value.topic=e),placeholder:"请输入文件主题或课程名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),f("div",pl,[f("div",vl,[f("h4",null,[l[26]||(l[26]=w("生成设置 ",-1)),f("span",ml,"共"+y(Me.value)+"题",1)])]),f("div",fl,[h(c,{label:"语言"},{default:b(()=>[h(u,{modelValue:Oe.value.language,"onUpdate:modelValue":l[5]||(l[5]=e=>Oe.value.language=e),placeholder:"选择语言",clearable:""},{default:b(()=>[(m(),v(_,null,k(xe,e=>h(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),h(c,{label:"难度"},{default:b(()=>[h(u,{modelValue:Oe.value.difficulty,"onUpdate:modelValue":l[6]||(l[6]=e=>Oe.value.difficulty=e),placeholder:"选择难度",clearable:""},{default:b(()=>[h(a,{label:"简单",value:q(ve).EASY},null,8,["value"]),h(a,{label:"中等",value:q(ve).MEDIUM},null,8,["value"]),h(a,{label:"困难",value:q(ve).HARD},null,8,["value"])]),_:1},8,["modelValue"])]),_:1})])]),f("div",gl,[l[27]||(l[27]=f("h4",null,"选择题型和数量",-1)),f("div",yl,[(m(!0),v(_,null,k(Ve.value,e=>(m(),v("div",{key:e.type,class:x(["question-type-item",{"is-enabled":e.enabled}])},[h(S,{modelValue:e.enabled,"onUpdate:modelValue":l=>e.enabled=l,label:e.label},null,8,["modelValue","onUpdate:modelValue","label"]),f("div",hl,[h(A,{icon:q(K),size:"small",circle:"",disabled:!e.enabled||e.count<=e.min,onClick:l=>fn(e)},null,8,["icon","disabled","onClick"]),h(pe,{modelValue:e.count,"onUpdate:modelValue":l=>e.count=l,min:e.min,max:e.max,disabled:!e.enabled,size:"small","controls-position":"right"},null,8,["modelValue","onUpdate:modelValue","min","max","disabled"]),h(A,{icon:q(D),size:"small",circle:"",disabled:!e.enabled||e.count>=e.max,onClick:l=>mn(e)},null,8,["icon","disabled","onClick"])])],2))),128))])])])]),_:1}),h(me,{label:"文本生成",name:"text"},{default:b(()=>[f("div",bl,[f("div",wl,[h(n,null,{default:b(()=>[h(q(Z))]),_:1}),l[28]||(l[28]=f("div",null,[f("h4",null,"基于文本描述生成题目"),f("p",null,"输入课程内容或知识点描述，基于文本内容智能生成相关练习题")],-1))]),h(d,{model:Ne.value,rules:Je,ref_key:"textFormRef",ref:$e,"label-width":"100px",size:"small"},{default:b(()=>[h(c,{label:"领域主题",prop:"topic"},{default:b(()=>[h(ge,{modelValue:Ne.value.topic,"onUpdate:modelValue":l[7]||(l[7]=e=>Ne.value.topic=e),placeholder:"请输入领域主题"},null,8,["modelValue"])]),_:1}),h(c,{label:"内容描述",prop:"content"},{default:b(()=>[h(ge,{modelValue:Ne.value.content,"onUpdate:modelValue":l[8]||(l[8]=e=>Ne.value.content=e),type:"textarea",rows:4,placeholder:"请输入课程内容、知识点或学习材料..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),f("div",_l,[f("div",kl,[f("h4",null,[l[29]||(l[29]=w("生成设置 ",-1)),f("span",xl,"共"+y(Me.value)+"题",1)])]),f("div",Vl,[h(c,{label:"语言"},{default:b(()=>[h(u,{modelValue:Ne.value.language,"onUpdate:modelValue":l[9]||(l[9]=e=>Ne.value.language=e),placeholder:"选择语言",clearable:""},{default:b(()=>[(m(),v(_,null,k(xe,e=>h(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),h(c,{label:"难度"},{default:b(()=>[h(u,{modelValue:Ne.value.difficulty,"onUpdate:modelValue":l[10]||(l[10]=e=>Ne.value.difficulty=e),placeholder:"选择难度",clearable:""},{default:b(()=>[h(a,{label:"简单",value:q(ve).EASY},null,8,["value"]),h(a,{label:"中等",value:q(ve).MEDIUM},null,8,["value"]),h(a,{label:"困难",value:q(ve).HARD},null,8,["value"])]),_:1},8,["modelValue"])]),_:1})])]),f("div",ql,[l[30]||(l[30]=f("h4",null,"选择题型和数量",-1)),f("div",Cl,[(m(!0),v(_,null,k(Ve.value,e=>(m(),v("div",{key:e.type,class:x(["question-type-item",{"is-enabled":e.enabled}])},[h(S,{modelValue:e.enabled,"onUpdate:modelValue":l=>e.enabled=l,label:e.label},null,8,["modelValue","onUpdate:modelValue","label"]),f("div",Il,[h(A,{icon:q(K),size:"small",circle:"",disabled:!e.enabled||e.count<=e.min,onClick:l=>fn(e)},null,8,["icon","disabled","onClick"]),h(pe,{modelValue:e.count,"onUpdate:modelValue":l=>e.count=l,min:e.min,max:e.max,disabled:!e.enabled,size:"small","controls-position":"right"},null,8,["modelValue","onUpdate:modelValue","min","max","disabled"]),h(A,{icon:q(D),size:"small",circle:"",disabled:!e.enabled||e.count>=e.max,onClick:l=>mn(e)},null,8,["icon","disabled","onClick"])])],2))),128))])])])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),f("div",Sl,[h(A,{type:"primary",size:"large",onClick:Be,loading:r.value,disabled:!Pe.value},{default:b(()=>[h(n,null,{default:b(()=>[h(q(Z))]),_:1}),l[31]||(l[31]=w(" 开始生成题目 ",-1))]),_:1},8,["loading","disabled"])])]),f("div",Al,[f("div",$l,[h(A,{onClick:vn},{default:b(()=>[...l[32]||(l[32]=[w("返回题库",-1)])]),_:1})]),r.value||0!==p.value.length?g("",!0):(m(),v("div",jl,[h(Re,{description:"这个区域是生成的试题"},{image:b(()=>[h(n,{size:100},{default:b(()=>[h(q(ee))]),_:1})]),_:1})])),qe.value.isStreaming?(m(),v("div",El,[h(De,null,{header:b(()=>[f("div",Ol,[l[33]||(l[33]=f("h3",null,"正在生成题目",-1)),f("div",Nl,[f("span",Ul,y(qe.value.currentQuestionIndex+1)+" / "+y(qe.value.totalCount),1),h(A,{type:"text",size:"small",onClick:gn},{default:b(()=>[Ce.value?(m(),V(n,{key:0},{default:b(()=>[h(q(ae))]),_:1})):(m(),V(n,{key:1},{default:b(()=>[h(q(te))]),_:1})),w(" "+y(Ce.value?"收起":"展开"),1)]),_:1})])])]),default:b(()=>[f("div",Tl,[h(n,{class:"rotating"},{default:b(()=>[h(q(le))]),_:1}),f("span",null,y(qe.value.currentPhase),1)]),h(Ke,{percentage:Math.round((qe.value.currentQuestionIndex+1)/qe.value.totalCount*100),"stroke-width":8},null,8,["percentage"]),f("div",{class:x(["streaming-output-window",{expanded:Ce.value}])},[f("div",{class:"streaming-content",ref_key:"streamingContentRef",ref:Ie},[f("div",{class:"streaming-json",innerHTML:qe.value.rawOutput},null,8,Jl)],512)],2)]),_:1})])):g("",!0),r.value&&!qe.value.isStreaming?(m(),v("div",Pl,[h(De,null,{header:b(()=>[...l[34]||(l[34]=[f("h3",null,"生成进度",-1)])]),default:b(()=>[f("div",Ml,[h(He,{title:C.value,type:I.value,closable:!1,"show-icon":""},null,8,["title","type"]),f("div",Dl,[h(Ke,{percentage:$.value,"stroke-width":8,"show-text":!0},null,8,["percentage"])])])]),_:1})])):g("",!0),qe.value.questions.length>0?(m(),v("div",Fl,[h(De,null,{header:b(()=>[...l[35]||(l[35]=[f("h3",null,"正在生成的题目",-1)])]),default:b(()=>[f("div",zl,[(m(!0),v(_,null,k(qe.value.questions,(e,a)=>{return m(),v("div",{key:a,class:x(["question-item",{"is-generating":e.isGenerating}])},[e.content?(m(),v("div",Ql,y(e.content),1)):g("",!0),e.options?(m(),v("div",Ll,[(m(!0),v(_,null,k(e.options,(e,l)=>(m(),v("div",{key:l,class:"option"},y(String.fromCharCode(65+l))+". "+y(e),1))),128))])):g("",!0),e.answer?(m(),v("div",Bl,[l[36]||(l[36]=f("strong",null,"答案：",-1)),w(y(e.answer),1)])):g("",!0),e.explanation?(m(),v("div",Gl,[l[37]||(l[37]=f("strong",null,"解析：",-1)),w(y(e.explanation),1)])):g("",!0),e.isGenerating?(m(),v("div",Rl,[h(n,{class:"rotating"},{default:b(()=>[h(q(le))]),_:1}),f("span",null,"正在生成"+y((t=e.generatingField,{content:"题目内容",options:"选项",answer:"答案",explanation:"解析"}[t]||""))+"...",1)])):g("",!0)],2);var t}),128))])]),_:1})])):g("",!0),p.value.length>0?(m(),v("div",Kl,[h(De,null,{header:b(()=>[f("div",Hl,[l[41]||(l[41]=f("h3",null,"生成结果",-1)),f("div",Wl,[h(A,{onClick:rn},{default:b(()=>[h(n,null,{default:b(()=>[h(q(oe))]),_:1}),l[38]||(l[38]=w(" 导出题目 ",-1))]),_:1}),h(A,{type:"primary",onClick:dn},{default:b(()=>[h(n,null,{default:b(()=>[h(q(D))]),_:1}),l[39]||(l[39]=w(" 保存到题库 ",-1))]),_:1}),h(A,{onClick:pn},{default:b(()=>[h(n,null,{default:b(()=>[h(q(ie))]),_:1}),l[40]||(l[40]=w(" 预览测试 ",-1))]),_:1})])])]),default:b(()=>[f("div",Yl,[(m(!0),v(_,null,k(p.value,(e,a)=>{return m(),v("div",{key:a,class:"question-item"},[f("div",Xl,[f("span",Zl,y(a+1)+".",1),f("span",en,y((s=e.type,{single:"单选题",multiple:"多选题",judge:"判断题",fill:"填空题",essay:"简答题"}[s]||s)),1),f("span",ln,y((t=e.difficulty,{easy:"简单",medium:"中等",hard:"困难"}[t]||t)),1),f("div",nn,[h(A,{type:"text",size:"small",onClick:l=>((e,l)=>{be.value=i({},e),we.value=l,de.value=!0})(e,a)},{default:b(()=>[h(n,null,{default:b(()=>[h(q(Z))]),_:1})]),_:1},8,["onClick"]),h(A,{type:"text",size:"small",onClick:e=>(e=>{p.value.splice(e,1),O.success("题目删除成功")})(a)},{default:b(()=>[h(n,null,{default:b(()=>[h(q(M))]),_:1})]),_:1},8,["onClick"])])]),f("div",an,y(e.content),1),e.options?(m(),v("div",tn,[(m(!0),v(_,null,k(e.options,(e,l)=>(m(),v("div",{key:l,class:"option"},y(String.fromCharCode(65+l))+". "+y(e),1))),128))])):g("",!0),f("div",sn,[l[42]||(l[42]=f("strong",null,"答案：",-1)),w(y(e.answer),1)]),f("div",on,[l[43]||(l[43]=f("strong",null,"解析：",-1)),w(y(e.explanation),1)])]);var t,s}),128))])]),_:1})])):g("",!0)])]),h(We,{visible:de.value,"onUpdate:visible":l[12]||(l[12]=e=>de.value=e),question:be.value,"is-edit":!0,onSave:un},null,8,["visible","question"]),h(yn,{"model-value":ye.value,title:"题目预览测试",width:"800px","close-on-click-modal":!1,"onUpdate:modelValue":l[14]||(l[14]=e=>ye.value=e)},{default:b(()=>[h(Ge,{questions:p.value,onClose:l[13]||(l[13]=e=>ye.value=!1)},null,8,["questions"])]),_:1},8,["model-value"]),h(yn,{modelValue:_e.value,"onUpdate:modelValue":l[18]||(l[18]=e=>_e.value=e),title:"导出题目",width:"400px","close-on-click-modal":!1},{footer:b(()=>[h(A,{onClick:l[17]||(l[17]=e=>_e.value=!1)},{default:b(()=>[...l[49]||(l[49]=[w("取消",-1)])]),_:1}),h(A,{type:"primary",onClick:cn},{default:b(()=>[...l[50]||(l[50]=[w("开始导出",-1)])]),_:1})]),default:b(()=>[h(d,{model:ke.value,"label-width":"80px"},{default:b(()=>[h(c,{label:"导出格式"},{default:b(()=>[h(bn,{modelValue:ke.value.format,"onUpdate:modelValue":l[15]||(l[15]=e=>ke.value.format=e)},{default:b(()=>[h(hn,{label:"excel"},{default:b(()=>[...l[44]||(l[44]=[w("Excel",-1)])]),_:1}),h(hn,{label:"csv"},{default:b(()=>[...l[45]||(l[45]=[w("CSV",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),h(c,{label:"包含内容"},{default:b(()=>[h(wn,{modelValue:ke.value.include,"onUpdate:modelValue":l[16]||(l[16]=e=>ke.value.include=e)},{default:b(()=>[h(S,{label:"options"},{default:b(()=>[...l[46]||(l[46]=[w("选项",-1)])]),_:1}),h(S,{label:"answer"},{default:b(()=>[...l[47]||(l[47]=[w("答案",-1)])]),_:1}),h(S,{label:"explanation"},{default:b(()=>[...l[48]||(l[48]=[w("解析",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-22290317"]]);export{un as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-BZfRVGvu.js","assets/index-B0rpCtHA.js","assets/vue-vendor-BRizdQXW.js","assets/element-plus-1qB5igSe.js","assets/index-DslGysim.css"])))=>i.map(i=>d[i]);
var e=(e,t,n)=>new Promise((s,r)=>{var i=e=>{try{o(n.next(e))}catch(t){r(t)}},a=e=>{try{o(n.throw(e))}catch(t){r(t)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,a);o((n=n.apply(e,t)).next())});import{_ as t}from"./index-B0rpCtHA.js";class n{static exportToExcel(n,s){return e(this,null,function*(){try{const e=yield t(()=>import("./xlsx-DfDjAMCE.js"),[]),r=this.prepareExcelData(n,s),i=e.utils.book_new(),a=e.utils.aoa_to_sheet(r),o=[{wch:10},{wch:15},{wch:10},{wch:50},{wch:20},{wch:20},{wch:20},{wch:20},{wch:15},{wch:30},{wch:20},{wch:15}];a["!cols"]=o,e.utils.book_append_sheet(i,a,"题目列表");const c=`题目列表_${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;e.writeFile(i,c)}catch(e){throw console.error("Excel导出失败:",e),new Error("Excel导出失败，请检查浏览器是否支持文件下载")}})}static exportToWord(n,s){return e(this,null,function*(){try{const{Document:r,Packer:i,Paragraph:a,TextRun:o,HeadingLevel:c,AlignmentType:l}=yield t(()=>e(null,null,function*(){const{Document:e,Packer:t,Paragraph:n,TextRun:s,HeadingLevel:r,AlignmentType:i}=yield import("./index-gYsxr632.js");return{Document:e,Packer:t,Paragraph:n,TextRun:s,HeadingLevel:r,AlignmentType:i}}),[]),p=new r({sections:[{properties:{},children:this.prepareWordContent(n,s,p)}]}),u=yield i.toBuffer(p),h=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),d=URL.createObjectURL(h),g=document.createElement("a");g.href=d;const w=(new Date).toISOString().slice(0,19).replace(/:/g,"-");g.download=`题目列表_${w}.docx`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(d)}catch(r){throw console.error("Word导出失败:",r),new Error("Word导出失败，请检查浏览器是否支持文件下载")}})}static exportToPDF(n,s){return e(this,null,function*(){try{const{jsPDF:r}=yield t(()=>e(null,null,function*(){const{jsPDF:e}=yield import("./jspdf.es.min-BZfRVGvu.js").then(e=>e.j);return{jsPDF:e}}),__vite__mapDeps([0,1,2,3,4]));yield t(()=>import("./jspdf.plugin.autotable-B4VyMk1H.js"),[]);const i=new r;i.setFontSize(16),i.text("题目列表",14,22);const a=this.preparePDFData(n,s);i.autoTable({head:[["序号","题型","难度","题目内容","选项A","选项B","选项C","选项D","答案","解析"]],body:a,startY:30,styles:{fontSize:8},headStyles:{fillColor:[66,139,202]},alternateRowStyles:{fillColor:[245,245,245]}});const o=`题目列表_${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.pdf`;i.save(o)}catch(r){throw console.error("PDF导出失败:",r),new Error("PDF导出失败，请检查浏览器是否支持文件下载")}})}static exportToCSV(t,n){return e(this,null,function*(){try{const e=this.prepareCSVData(t,n),s=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(s),i=document.createElement("a");i.href=r;const a=(new Date).toISOString().slice(0,19).replace(/:/g,"-");i.download=`题目列表_${a}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}catch(e){throw console.error("CSV导出失败:",e),new Error("CSV导出失败，请检查浏览器是否支持文件下载")}})}static prepareExcelData(e,t){const n=["序号","题型","难度","题目内容"],s=e.some(e=>e.options&&e.options.length>0);s&&n.push("选项A","选项B","选项C","选项D"),t.includeAnswers&&n.push("答案"),t.includeExplanations&&n.push("解析"),t.includeMetadata&&n.push("标签","创建时间");const r=[n];return e.forEach((e,n)=>{const i=[n+1,this.getTypeText(e.type),this.getDifficultyText(e.difficulty),e.content];if(s){const t=e.options||[];i.push(t[0]||"",t[1]||"",t[2]||"",t[3]||"")}t.includeAnswers&&i.push(e.answer),t.includeExplanations&&i.push(e.explanation),t.includeMetadata&&i.push((e.tags||[]).join(", "),new Date(e.createdAt).toLocaleDateString()),r.push(i)}),r}static prepareWordContent(e,t,n){const s=[];return s.push(new n.Paragraph({text:"题目列表",heading:n.HeadingLevel.TITLE,alignment:n.AlignmentType.CENTER})),e.forEach((e,r)=>{if(s.push(new n.Paragraph({text:`${r+1}. ${e.content}`,heading:n.HeadingLevel.HEADING_2})),s.push(new n.Paragraph({text:`题型：${this.getTypeText(e.type)} | 难度：${this.getDifficultyText(e.difficulty)}`,style:"caption"})),e.options&&e.options.length>0&&e.options.forEach((e,t)=>{e&&s.push(new n.Paragraph({text:`${String.fromCharCode(65+t)}. ${e}`,indent:{left:720}}))}),t.includeAnswers){const t=Array.isArray(e.answer)?e.answer.join(", "):String(e.answer||"");s.push(new n.Paragraph({text:`答案：${t}`,style:"caption"}))}if(t.includeExplanations){const t=String(e.explanation||"");s.push(new n.Paragraph({text:`解析：${t}`,style:"caption"}))}s.push(new n.Paragraph({text:"",spacing:{after:200}}))}),s}static preparePDFData(e,t){return e.map((e,t)=>{var n,s,r,i;return[t+1,this.getTypeText(e.type),this.getDifficultyText(e.difficulty),e.content.substring(0,50)+(e.content.length>50?"...":""),((null==(n=e.options)?void 0:n[0])||"").substring(0,20),((null==(s=e.options)?void 0:s[1])||"").substring(0,20),((null==(r=e.options)?void 0:r[2])||"").substring(0,20),((null==(i=e.options)?void 0:i[3])||"").substring(0,20),e.answer.substring(0,20),e.explanation.substring(0,30)]})}static getTypeText(e){return{single:"单选题",multiple:"多选题",judge:"判断题",fill:"填空题",essay:"简答题"}[e]||e}static getDifficultyText(e){return{easy:"简单",medium:"中等",hard:"困难"}[e]||e}static prepareCSVData(e,t){const n=[],s=["序号","题型","难度","题目内容"],r=e.some(e=>e.options&&e.options.length>0);return r&&s.push("选项A","选项B","选项C","选项D"),t.includeAnswers&&s.push("答案"),t.includeExplanations&&s.push("解析"),t.includeMetadata&&s.push("标签","创建时间"),n.push(s.map(e=>this.escapeCSV(e)).join(",")),e.forEach((e,s)=>{const i=[String(s+1),this.getTypeText(e.type),this.getDifficultyText(e.difficulty),this.escapeCSV(String(e.content||""))];if(r){const t=e.options||[];i.push(this.escapeCSV(t[0]||""),this.escapeCSV(t[1]||""),this.escapeCSV(t[2]||""),this.escapeCSV(t[3]||""))}if(t.includeAnswers){const t=Array.isArray(e.answer)?e.answer.join(", "):String(e.answer||"");i.push(this.escapeCSV(t))}t.includeExplanations&&i.push(this.escapeCSV(String(e.explanation||""))),t.includeMetadata&&i.push(this.escapeCSV((e.tags||[]).join("; ")),new Date(e.createdAt).toLocaleDateString()),n.push(i.join(","))}),n.join("\n")}static escapeCSV(e){if(null==e)return"";const t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")||t.includes("\r")?`"${t.replace(/"/g,'""')}"`:t}}export{n as Q};

var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,u=(e,l,a)=>new Promise((t,s)=>{var u=e=>{try{n(a.next(e))}catch(l){s(l)}},o=e=>{try{n(a.throw(e))}catch(l){s(l)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(u,o);n((a=a.apply(e,l)).next())});/* empty css             *//* empty css                   *//* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                 *//* empty css                  *//* empty css                         *//* empty css                    */import{y as o,c as n,j as i,z as d,B as c,L as r,R as v,u as p,P as m,A as f,r as y,I as g,J as h,E as b,Q as _,a5 as k,O as V,W as C,h as w,K as x,S as q,aB as Q}from"./vue-vendor-BRizdQXW.js";import{l as j,c as I,m as U,a as z,t as S,r as B,F as G,G as A,Q as T,R as D,u as E,S as O,T as P,U as R,z as F,V as M,M as W,L,D as $,E as K,K as N,A as J,B as X,C as Y,j as H}from"./index-CgjG02ur.js";import{useQuestionStore as Z}from"./question-CtH6naOE.js";import{u as ee}from"./course-DWSJBfyD.js";import{_ as le}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{T as ae,h as te,f as se,c as ue,b as oe,d as ne,y as ie,B as de,e as ce,U as re,V as ve,W as pe,E as me,F as fe,X as ye,Y as ge,z as he,A as be,C as _e,v as ke,w as Ve,q as Ce}from"./element-plus-1qB5igSe.js";/* empty css                          *//* empty css                       *//* empty css                *//* empty css                     */import{Q as we}from"./questionExporter-CfuwiSIR.js";import"./storage-B26rRKbu.js";import"./index-B0rpCtHA.js";const xe={class:"question-stats-cards"},qe={class:"stats-grid"},Qe={class:"stat-card brand-card"},je={class:"stat-icon total"},Ie={class:"stat-content"},Ue={class:"stat-number"},ze={key:0,class:"stat-trend"},Se={class:"stat-card brand-card"},Be={class:"stat-icon today"},Ge={class:"stat-content"},Ae={class:"stat-number"},Te={class:"stat-card brand-card"},De={class:"stat-icon usage"},Ee={class:"stat-content"},Oe={class:"stat-number"},Pe={class:"stat-card brand-card"},Re={class:"stat-icon quality"},Fe={class:"stat-content"},Me={class:"stat-number"},We=le(o({__name:"QuestionStatsCards",setup(e){j.add(I,U,z,S,B);const l=Z(),a=n(()=>{const e=l.questions,a=e.length,t=(new Date).toDateString();return{totalQuestions:a,todayAdded:e.filter(e=>new Date(e.createdAt).toDateString()===t).length,totalUsage:e.reduce((e,l)=>e+(l.usageCount||0),0),averageQuality:e.length>0?Math.round(e.reduce((e,l)=>e+(l.qualityScore||0),0)/e.length):0}});return i(()=>{}),(e,l)=>(f(),d("div",xe,[c("div",qe,[c("div",Qe,[c("div",je,[v(p(G),{icon:["fas","question-circle"]})]),c("div",Ie,[c("div",Ue,m(a.value.totalQuestions),1),l[0]||(l[0]=c("div",{class:"stat-label"},"总题数",-1))]),a.value.todayAdded>0?(f(),d("div",ze,[v(p(G),{icon:["fas","arrow-up"]}),c("span",null,"+"+m(a.value.todayAdded),1)])):r("",!0)]),c("div",Se,[c("div",Be,[v(p(G),{icon:["fas","plus-circle"]})]),c("div",Ge,[c("div",Ae,m(a.value.todayAdded),1),l[1]||(l[1]=c("div",{class:"stat-label"},"今日新增",-1))])]),c("div",Te,[c("div",De,[v(p(G),{icon:["fas","chart-line"]})]),c("div",Ee,[c("div",Oe,m(a.value.totalUsage),1),l[2]||(l[2]=c("div",{class:"stat-label"},"总使用次数",-1))])]),c("div",Pe,[c("div",Re,[v(p(G),{icon:["fas","star"]})]),c("div",Fe,[c("div",Me,m(a.value.averageQuality)+"%",1),l[3]||(l[3]=c("div",{class:"stat-label"},"平均质量",-1))])])])]))}}),[["__scopeId","data-v-205b09ae"]]),Le={class:"question-type-nav"},$e={class:"nav-header"},Ke={class:"nav-list"},Ne={class:"nav-item-content"},Je={class:"nav-icon all"},Xe=["onClick"],Ye={class:"nav-item-content"},He={class:"nav-label"},Ze={key:0,class:"nav-groups"},el={class:"groups-header"},ll={class:"groups-list"},al=["onClick"],tl={class:"nav-item-content"},sl={class:"nav-icon group"},ul={class:"nav-label"},ol=le(o({__name:"QuestionTypeNav",props:{selectedType:{}},emits:["type-select","create-group"],setup(e,{emit:l}){j.add(A,T,D,E,O,P,R,F,M,W);const a=Z(),t=y(!1),s=y(!1),u=n(()=>a.questionsByType),o=n(()=>a.questionCount),V=n(()=>a.questionGroups||[]),C=()=>{t.value=!t.value},w=e=>{U("type-select",e)},x=()=>{U("create-group")},q=e=>({single:"circle-dot",multiple:"square-check",judge:"question",fill:"pen",essay:"file-alt"}[e]||"question"),Q=e=>({single:"单选题",multiple:"多选题",judge:"判断题",fill:"填空题",essay:"简答题"}[e]||"未知"),I=()=>{s.value=window.innerWidth<=768,s.value&&(t.value=!0)},U=l;return i(()=>{I(),window.addEventListener("resize",I)}),(l,a)=>{const n=te,i=ae;return f(),d("div",Le,[c("div",$e,[a[1]||(a[1]=c("h3",null,"题目分类",-1)),s.value?(f(),g(n,{key:0,type:"text",size:"small",onClick:C},{default:h(()=>[v(p(G),{icon:["fas",t.value?"chevron-down":"chevron-up"]},null,8,["icon"])]),_:1})):r("",!0)]),c("div",{class:b(["nav-content",{collapsed:t.value}])},[c("div",Ke,[c("div",{class:b(["nav-item",{active:"all"===e.selectedType}]),onClick:a[0]||(a[0]=e=>w("all"))},[c("div",Ne,[c("div",Je,[v(p(G),{icon:["fas","list"]})]),a[2]||(a[2]=c("span",{class:"nav-label"},"全部题目",-1)),v(i,{value:o.value,max:999,class:"nav-badge"},null,8,["value"])])],2),(f(!0),d(_,null,k(u.value,(l,a)=>(f(),d("div",{key:a,class:b(["nav-item",{active:e.selectedType===a}]),onClick:e=>w(a)},[c("div",Ye,[c("div",{class:b(["nav-icon",a])},[v(p(G),{icon:q(a)},null,8,["icon"])],2),c("span",He,m(Q(a)),1),v(i,{value:l,max:999,class:"nav-badge"},null,8,["value"])])],10,Xe))),128))]),V.value.length>0?(f(),d("div",Ze,[c("div",el,[a[3]||(a[3]=c("h4",null,"题库分组",-1)),v(n,{type:"text",size:"small",onClick:x},{default:h(()=>[v(p(G),{icon:["fas","plus"]})]),_:1})]),c("div",ll,[(f(!0),d(_,null,k(V.value,l=>(f(),d("div",{key:l.id,class:b(["nav-item group-item",{active:e.selectedType===`group_${l.id}`}]),onClick:e=>{return a=l.id,void U("type-select",`group_${a}`);var a}},[c("div",tl,[c("div",sl,[v(p(G),{icon:["fas","folder"]})]),c("span",ul,m(l.name),1),v(i,{value:l.questionCount,max:999,class:"nav-badge"},null,8,["value"])])],10,al))),128))])])):r("",!0)],2)])}}}),[["__scopeId","data-v-ee056198"]]),nl={class:"question-batch-toolbar"},il={class:"toolbar-content"},dl={class:"selection-info"},cl={class:"batch-actions"},rl=le(o({__name:"QuestionBatchToolbar",props:{selectedQuestions:{},totalQuestions:{}},emits:["select-all","batch-delete","batch-modify","batch-move","batch-export","clear-selection"],setup(e,{emit:l}){j.add(L,$,O,K,N);const a=Z(),t=e,s=y(!1),o=y(!1),i=y(!1),r=y(!1),b=y({difficulty:"",tags:"",status:""}),C=y({groupId:""}),w=y({format:"excel",include:["options","answer","explanation"]}),x=n(()=>t.selectedQuestions.length),q=n(()=>x.value>0&&x.value<t.totalQuestions),Q=n(()=>a.questionGroups||[]),I=()=>{r.value=!0},U=()=>{o.value=!0},z=()=>{i.value=!0},S=()=>u(null,null,function*(){try{yield fe.confirm(`确认删除选中的 ${x.value} 道题目吗？此操作不可撤销。`,"批量删除",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}),yield a.batchDeleteQuestions(t.selectedQuestions),me.success("批量删除成功"),E("batch-delete",t.selectedQuestions)}catch(e){}}),B=()=>{E("clear-selection")},A=()=>u(null,null,function*(){try{const e={};b.value.difficulty&&(e.difficulty=b.value.difficulty),b.value.tags&&(e.tags=b.value.tags.split(",").map(e=>e.trim())),b.value.status&&(e.status=b.value.status),yield a.batchUpdateQuestions(t.selectedQuestions,e),me.success("批量修改成功"),o.value=!1,E("batch-modify",{questionIds:t.selectedQuestions,updateData:e})}catch(e){me.error("批量修改失败")}}),T=()=>u(null,null,function*(){try{yield a.addQuestionsToGroup(C.value.groupId,t.selectedQuestions),me.success("移动成功"),i.value=!1,E("batch-move",{questionIds:t.selectedQuestions,groupId:C.value.groupId})}catch(e){me.error("移动失败")}}),D=()=>u(null,null,function*(){try{const e=a.questions.filter(e=>t.selectedQuestions.includes(e.id)),l={format:w.value.format,includeAnswers:w.value.include.includes("answer"),includeExplanations:w.value.include.includes("explanation"),includeMetadata:w.value.include.includes("options")};switch(l.format){case"excel":yield we.exportToExcel(e,l);break;case"word":yield we.exportToWord(e,l);break;case"pdf":yield we.exportToPDF(e,l);break;case"csv":yield we.exportToCSV(e,l)}me.success("导出成功"),r.value=!1,E("batch-export",{questionIds:t.selectedQuestions,format:w.value.format,include:w.value.include})}catch(e){console.error("导出失败:",e),me.error(e instanceof Error?e.message:"导出失败")}}),E=l;return(e,l)=>{const a=se,t=te,u=de,n=ie,y=ne,j=ce,O=oe,P=ue,R=ve,F=re,M=pe;return f(),d("div",nl,[c("div",il,[c("div",dl,[v(a,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value=e),indeterminate:q.value,onChange:l[1]||(l[1]=e=>{E("select-all",e)})},{default:h(()=>[V(" 已选择 "+m(x.value)+" 道题目 ",1)]),_:1},8,["modelValue","indeterminate"])]),c("div",cl,[v(t,{type:"primary",size:"small",onClick:I},{default:h(()=>[v(p(G),{icon:["fas","download"],class:"mr-2"}),l[14]||(l[14]=V(" 批量导出 ",-1))]),_:1}),v(t,{type:"success",size:"small",onClick:U},{default:h(()=>[v(p(G),{icon:["fas","edit"],class:"mr-2"}),l[15]||(l[15]=V(" 批量修改 ",-1))]),_:1}),v(t,{type:"warning",size:"small",onClick:z},{default:h(()=>[v(p(G),{icon:["fas","folder"],class:"mr-2"}),l[16]||(l[16]=V(" 移动到分组 ",-1))]),_:1}),v(t,{type:"danger",size:"small",onClick:S},{default:h(()=>[v(p(G),{icon:["fas","trash"],class:"mr-2"}),l[17]||(l[17]=V(" 批量删除 ",-1))]),_:1}),v(t,{type:"info",size:"small",onClick:B},{default:h(()=>[v(p(G),{icon:["fas","times"],class:"mr-2"}),l[18]||(l[18]=V(" 取消选择 ",-1))]),_:1})])]),v(P,{modelValue:o.value,"onUpdate:modelValue":l[6]||(l[6]=e=>o.value=e),title:"批量修改题目",width:"500px","close-on-click-modal":!1},{footer:h(()=>[v(t,{onClick:l[5]||(l[5]=e=>o.value=!1)},{default:h(()=>[...l[19]||(l[19]=[V("取消",-1)])]),_:1}),v(t,{type:"primary",onClick:A},{default:h(()=>[...l[20]||(l[20]=[V("确认修改",-1)])]),_:1})]),default:h(()=>[v(O,{model:b.value,"label-width":"80px"},{default:h(()=>[v(y,{label:"修改难度"},{default:h(()=>[v(n,{modelValue:b.value.difficulty,"onUpdate:modelValue":l[2]||(l[2]=e=>b.value.difficulty=e),placeholder:"选择难度",clearable:""},{default:h(()=>[v(u,{label:"简单",value:"easy"}),v(u,{label:"中等",value:"medium"}),v(u,{label:"困难",value:"hard"})]),_:1},8,["modelValue"])]),_:1}),v(y,{label:"添加标签"},{default:h(()=>[v(j,{modelValue:b.value.tags,"onUpdate:modelValue":l[3]||(l[3]=e=>b.value.tags=e),placeholder:"输入标签，多个标签用逗号分隔"},null,8,["modelValue"])]),_:1}),v(y,{label:"修改状态"},{default:h(()=>[v(n,{modelValue:b.value.status,"onUpdate:modelValue":l[4]||(l[4]=e=>b.value.status=e),placeholder:"选择状态",clearable:""},{default:h(()=>[v(u,{label:"激活",value:"active"}),v(u,{label:"归档",value:"archived"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),v(P,{modelValue:i.value,"onUpdate:modelValue":l[9]||(l[9]=e=>i.value=e),title:"移动到分组",width:"400px","close-on-click-modal":!1},{footer:h(()=>[v(t,{onClick:l[8]||(l[8]=e=>i.value=!1)},{default:h(()=>[...l[21]||(l[21]=[V("取消",-1)])]),_:1}),v(t,{type:"primary",onClick:T},{default:h(()=>[...l[22]||(l[22]=[V("确认移动",-1)])]),_:1})]),default:h(()=>[v(O,{model:C.value,"label-width":"80px"},{default:h(()=>[v(y,{label:"选择分组"},{default:h(()=>[v(n,{modelValue:C.value.groupId,"onUpdate:modelValue":l[7]||(l[7]=e=>C.value.groupId=e),placeholder:"选择目标分组"},{default:h(()=>[(f(!0),d(_,null,k(Q.value,e=>(f(),g(u,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),v(P,{modelValue:r.value,"onUpdate:modelValue":l[13]||(l[13]=e=>r.value=e),title:"导出题目",width:"400px","close-on-click-modal":!1},{footer:h(()=>[v(t,{onClick:l[12]||(l[12]=e=>r.value=!1)},{default:h(()=>[...l[30]||(l[30]=[V("取消",-1)])]),_:1}),v(t,{type:"primary",onClick:D},{default:h(()=>[...l[31]||(l[31]=[V("开始导出",-1)])]),_:1})]),default:h(()=>[v(O,{model:w.value,"label-width":"80px"},{default:h(()=>[v(y,{label:"导出格式"},{default:h(()=>[v(F,{modelValue:w.value.format,"onUpdate:modelValue":l[10]||(l[10]=e=>w.value.format=e)},{default:h(()=>[v(R,{label:"excel"},{default:h(()=>[...l[23]||(l[23]=[V("Excel",-1)])]),_:1}),v(R,{label:"word"},{default:h(()=>[...l[24]||(l[24]=[V("Word",-1)])]),_:1}),v(R,{label:"pdf"},{default:h(()=>[...l[25]||(l[25]=[V("PDF",-1)])]),_:1}),v(R,{label:"csv"},{default:h(()=>[...l[26]||(l[26]=[V("CSV",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),v(y,{label:"包含内容"},{default:h(()=>[v(M,{modelValue:w.value.include,"onUpdate:modelValue":l[11]||(l[11]=e=>w.value.include=e)},{default:h(()=>[v(a,{label:"options"},{default:h(()=>[...l[27]||(l[27]=[V("选项",-1)])]),_:1}),v(a,{label:"answer"},{default:h(()=>[...l[28]||(l[28]=[V("答案",-1)])]),_:1}),v(a,{label:"explanation"},{default:h(()=>[...l[29]||(l[29]=[V("解析",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-852d4180"]]),vl={class:"question-group-manager"},pl={class:"group-list"},ml={class:"group-header"},fl={class:"group-items"},yl=["onClick"],gl={class:"group-info"},hl={class:"group-name"},bl={class:"group-meta"},_l={class:"question-count"},kl={class:"group-date"},Vl={class:"group-actions"},Cl=le(o({__name:"QuestionGroupManager",props:{selectedGroupId:{}},emits:["group-select","group-created","group-updated","group-deleted"],setup(e,{emit:l}){j.add(E,$,K);const a=Z(),t=ee(),s=l,o=y(!1),r=y(null),w=y(),x=y({name:"",description:"",courseId:""}),q={name:[{required:!0,message:"请输入分组名称",trigger:"blur"},{min:2,max:50,message:"分组名称长度在 2 到 50 个字符",trigger:"blur"}],description:[{max:200,message:"分组描述不能超过 200 个字符",trigger:"blur"}]},Q=n(()=>a.questionGroups),I=n(()=>t.courses);i(()=>{U(),z()});const U=()=>u(null,null,function*(){try{yield a.fetchQuestionGroups()}catch(e){console.error("获取分组列表失败:",e)}}),z=()=>u(null,null,function*(){try{yield t.fetchCourses()}catch(e){console.error("获取课程列表失败:",e)}}),S=()=>u(null,null,function*(){try{yield w.value.validate();const e={name:x.value.name,description:x.value.description,courseId:x.value.courseId||void 0};if(r.value){const l=yield a.updateQuestionGroup(r.value.id,e);me.success("更新成功"),s("group-updated",l)}else{const l=yield a.createQuestionGroup(e);me.success("创建成功"),s("group-created",l)}B()}catch(e){console.error("保存分组失败:",e)}}),B=()=>{var e;o.value=!1,r.value=null,x.value={name:"",description:"",courseId:""},null==(e=w.value)||e.resetFields()};return(l,t)=>{const n=te,i=ce,y=ne,j=de,U=ie,z=oe,A=ue;return f(),d("div",vl,[c("div",pl,[c("div",ml,[t[6]||(t[6]=c("h3",null,"题目分组",-1)),v(n,{type:"primary",size:"small",onClick:t[0]||(t[0]=e=>o.value=!0)},{default:h(()=>[v(p(G),{icon:["fas","plus"],class:"mr-2"}),t[5]||(t[5]=V(" 新建分组 ",-1))]),_:1})]),c("div",fl,[(f(!0),d(_,null,k(Q.value,l=>{return f(),d("div",{key:l.id,class:b(["group-item",{active:e.selectedGroupId===l.id}]),onClick:e=>{return a=l.id,void s("group-select",a);var a}},[c("div",gl,[c("div",hl,m(l.name),1),c("div",bl,[c("span",_l,m(l.questionCount)+" 题",1),c("span",kl,m((t=l.createdAt,new Date(t).toLocaleDateString())),1)])]),c("div",Vl,[v(n,{type:"text",size:"small",onClick:C(e=>(e=>{r.value=e,x.value={name:e.name,description:e.description,courseId:e.courseId||""},o.value=!0})(l),["stop"])},{default:h(()=>[v(p(G),{icon:["fas","edit"]})]),_:1},8,["onClick"]),v(n,{type:"text",size:"small",onClick:C(e=>{return t=l.id,u(null,null,function*(){try{yield fe.confirm("确认删除该分组吗？","删除分组",{type:"warning"}),yield a.deleteQuestionGroup(t),me.success("删除成功"),s("group-deleted",t)}catch(e){"cancel"!==e&&me.error("删除失败")}});var t},["stop"])},{default:h(()=>[v(p(G),{icon:["fas","trash"]})]),_:1},8,["onClick"])])],10,yl);var t}),128))])]),v(A,{modelValue:o.value,"onUpdate:modelValue":t[4]||(t[4]=e=>o.value=e),title:r.value?"编辑分组":"新建分组",width:"500px","close-on-click-modal":!1},{footer:h(()=>[v(n,{onClick:B},{default:h(()=>[...t[7]||(t[7]=[V("取消",-1)])]),_:1}),v(n,{type:"primary",onClick:S},{default:h(()=>[V(m(r.value?"保存":"创建"),1)]),_:1})]),default:h(()=>[v(z,{model:x.value,rules:q,ref_key:"groupFormRef",ref:w,"label-width":"80px"},{default:h(()=>[v(y,{label:"分组名称",prop:"name"},{default:h(()=>[v(i,{modelValue:x.value.name,"onUpdate:modelValue":t[1]||(t[1]=e=>x.value.name=e),placeholder:"请输入分组名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),v(y,{label:"分组描述",prop:"description"},{default:h(()=>[v(i,{modelValue:x.value.description,"onUpdate:modelValue":t[2]||(t[2]=e=>x.value.description=e),type:"textarea",placeholder:"请输入分组描述",rows:3,maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),v(y,{label:"关联课程",prop:"courseId"},{default:h(()=>[v(U,{modelValue:x.value.courseId,"onUpdate:modelValue":t[3]||(t[3]=e=>x.value.courseId=e),placeholder:"选择关联课程（可选）",clearable:"",filterable:""},{default:h(()=>[(f(!0),d(_,null,k(I.value,e=>(f(),g(j,{key:e.id,label:e.title,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-a88855e8"]]),wl={class:"question-advanced-filter"},xl={class:"basic-search"},ql={class:"advanced-panel"},Ql={class:"filter-row"},jl={class:"filter-group"},Il={class:"filter-group"},Ul={class:"filter-row"},zl={class:"filter-group"},Sl={class:"filter-group"},Bl={class:"filter-row"},Gl={class:"filter-group"},Al={class:"filter-group"},Tl={class:"sort-controls"},Dl={class:"filter-actions"},El=le(o({__name:"QuestionAdvancedFilter",props:{modelValue:{}},emits:["update:modelValue","search"],setup(e,{emit:u}){j.add(J,T,D);const o=ee(),i=Z(),r=e,b=u,C=y(!1),Q=y({keyword:"",type:void 0,difficulty:void 0,courseId:void 0,page:1,pageSize:10,types:[],difficulties:[],tags:[],dateRange:[],sortBy:"createdAt",sortOrder:"desc"}),I=n(()=>o.courses),U=n(()=>{const e=new Set;return i.questions.forEach(l=>{l.tags&&l.tags.forEach(l=>e.add(l))}),Array.from(e)});w(()=>r.modelValue,e=>{Q.value=((e,u)=>{for(var o in u||(u={}))a.call(u,o)&&s(e,o,u[o]);if(l)for(var o of l(u))t.call(u,o)&&s(e,o,u[o]);return e})({},e)},{immediate:!0,deep:!0}),w(Q,e=>{b("update:modelValue",e)},{deep:!0});const z=()=>{C.value=!C.value},S=()=>{b("search",Q.value)},B=()=>{b("search",Q.value)},A=()=>{Q.value={keyword:"",type:void 0,difficulty:void 0,courseId:void 0,page:1,pageSize:10,types:[],difficulties:[],tags:[],dateRange:[],sortBy:"createdAt",sortOrder:"desc"},b("search",Q.value)};return(e,l)=>{const a=ce,t=te,s=se,u=pe,o=de,n=ie,i=ge,r=ye;return f(),d("div",wl,[c("div",xl,[v(a,{modelValue:Q.value.keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>Q.value.keyword=e),placeholder:"搜索题目内容...",clearable:"",onInput:S,class:"search-input"},{prefix:h(()=>[v(p(G),{icon:["fas","search"]})]),_:1},8,["modelValue"]),v(t,{type:"primary",onClick:S,class:"search-btn"},{default:h(()=>[...l[8]||(l[8]=[V(" 搜索 ",-1)])]),_:1}),v(t,{onClick:z,class:"advanced-toggle"},{default:h(()=>[v(p(G),{icon:["fas",C.value?"chevron-up":"chevron-down"]},null,8,["icon"]),V(" "+m(C.value?"收起":"高级筛选"),1)]),_:1})]),v(r,null,{default:h(()=>[x(c("div",ql,[c("div",Ql,[c("div",jl,[l[14]||(l[14]=c("label",{class:"filter-label"},"题型",-1)),v(u,{modelValue:Q.value.types,"onUpdate:modelValue":l[1]||(l[1]=e=>Q.value.types=e),onChange:S},{default:h(()=>[v(s,{label:"single"},{default:h(()=>[...l[9]||(l[9]=[V("单选题",-1)])]),_:1}),v(s,{label:"multiple"},{default:h(()=>[...l[10]||(l[10]=[V("多选题",-1)])]),_:1}),v(s,{label:"judge"},{default:h(()=>[...l[11]||(l[11]=[V("判断题",-1)])]),_:1}),v(s,{label:"fill"},{default:h(()=>[...l[12]||(l[12]=[V("填空题",-1)])]),_:1}),v(s,{label:"essay"},{default:h(()=>[...l[13]||(l[13]=[V("简答题",-1)])]),_:1})]),_:1},8,["modelValue"])]),c("div",Il,[l[18]||(l[18]=c("label",{class:"filter-label"},"难度",-1)),v(u,{modelValue:Q.value.difficulties,"onUpdate:modelValue":l[2]||(l[2]=e=>Q.value.difficulties=e),onChange:S},{default:h(()=>[v(s,{label:"easy"},{default:h(()=>[...l[15]||(l[15]=[V("简单",-1)])]),_:1}),v(s,{label:"medium"},{default:h(()=>[...l[16]||(l[16]=[V("中等",-1)])]),_:1}),v(s,{label:"hard"},{default:h(()=>[...l[17]||(l[17]=[V("困难",-1)])]),_:1})]),_:1},8,["modelValue"])])]),c("div",Ul,[c("div",zl,[l[19]||(l[19]=c("label",{class:"filter-label"},"课程",-1)),v(n,{modelValue:Q.value.courseId,"onUpdate:modelValue":l[3]||(l[3]=e=>Q.value.courseId=e),placeholder:"选择课程",clearable:"",onChange:S,class:"filter-select"},{default:h(()=>[(f(!0),d(_,null,k(I.value,e=>(f(),g(o,{key:e.id,label:e.title,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),c("div",Sl,[l[20]||(l[20]=c("label",{class:"filter-label"},"标签",-1)),v(n,{modelValue:Q.value.tags,"onUpdate:modelValue":l[4]||(l[4]=e=>Q.value.tags=e),placeholder:"选择标签",multiple:"",clearable:"",onChange:S,class:"filter-select"},{default:h(()=>[(f(!0),d(_,null,k(U.value,e=>(f(),g(o,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),c("div",Bl,[c("div",Gl,[l[21]||(l[21]=c("label",{class:"filter-label"},"创建时间",-1)),v(i,{modelValue:Q.value.dateRange,"onUpdate:modelValue":l[5]||(l[5]=e=>Q.value.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:S,class:"filter-date"},null,8,["modelValue"])]),c("div",Al,[l[22]||(l[22]=c("label",{class:"filter-label"},"排序",-1)),c("div",Tl,[v(n,{modelValue:Q.value.sortBy,"onUpdate:modelValue":l[6]||(l[6]=e=>Q.value.sortBy=e),onChange:S,class:"sort-select"},{default:h(()=>[v(o,{label:"创建时间",value:"createdAt"}),v(o,{label:"更新时间",value:"updatedAt"}),v(o,{label:"使用次数",value:"usageCount"}),v(o,{label:"正确率",value:"correctRate"}),v(o,{label:"质量评分",value:"qualityScore"})]),_:1},8,["modelValue"]),v(n,{modelValue:Q.value.sortOrder,"onUpdate:modelValue":l[7]||(l[7]=e=>Q.value.sortOrder=e),onChange:S,class:"sort-order"},{default:h(()=>[v(o,{label:"升序",value:"asc"}),v(o,{label:"降序",value:"desc"})]),_:1},8,["modelValue"])])])]),c("div",Dl,[v(t,{onClick:A},{default:h(()=>[...l[23]||(l[23]=[V("重置筛选",-1)])]),_:1}),v(t,{type:"primary",onClick:B},{default:h(()=>[...l[24]||(l[24]=[V("应用筛选",-1)])]),_:1})])],512),[[q,C.value]])]),_:1})])}}}),[["__scopeId","data-v-544fd1b2"]]),Ol={class:"question-bank-layout"},Pl={class:"main-content"},Rl={class:"left-nav"},Fl={class:"group-section"},Ml={class:"question-list-area"},Wl={class:"page-header"},Ll={class:"header-actions"},$l={class:"questions-grid"},Kl={key:0,class:"empty-state"},Nl={class:"empty-icon"},Jl={class:"question-header"},Xl={class:"question-checkbox"},Yl={class:"question-meta"},Hl={class:"question-actions"},Zl={class:"question-content"},ea={class:"question-text"},la={key:0,class:"question-options"},aa={class:"option-label"},ta={class:"option-text"},sa={class:"question-footer"},ua={class:"question-stats"},oa={class:"stat-item"},na={class:"stat-item"},ia={key:1,class:"pagination"},da={key:0,class:"question-preview"},ca={class:"preview-header"},ra={class:"preview-content"},va={key:0},pa={class:"option-label"},ma={class:"option-text"},fa={class:"answer-section"},ya={class:"answer-text"},ga={class:"explanation-section"},ha={class:"explanation-text"},ba=le(o({__name:"QuestionBank",setup(e){j.add(E,J,I,X,$,Y,K,z,H);const l=Q(),a=Z(),t=ee(),s=y(!1),o=y([]),n=y([]),b=y(0),w=y(1),q=y(10),U=y(!1),S=y(null),B=y([]),A=y("all"),T=y(""),D=y({keyword:"",type:void 0,difficulty:void 0,courseId:void 0,page:1,pageSize:10});i(()=>{O(),P()});const O=()=>u(null,null,function*(){try{s.value=!0,D.value.page=w.value,D.value.pageSize=q.value;const e=yield a.fetchQuestions(D.value);o.value=e.questions,b.value=e.total}catch(e){console.error("获取题目列表失败:",e),me.error("获取题目列表失败")}finally{s.value=!1}}),P=()=>u(null,null,function*(){try{const e=yield t.fetchCourses();n.value=e.courses}catch(e){console.error("获取课程列表失败:",e)}}),R=()=>{w.value=1,O()},F=e=>{q.value=e,w.value=1,O()},M=e=>{w.value=e,O()},W=()=>{l.push("/questions/generate")},L=e=>{l.push(`/questions/edit/${e}`)},N=e=>{A.value=e,"all"===e?D.value.type=void 0:e.startsWith("group_")||(D.value.type=e),R()},le=()=>{me.info("创建分组功能待实现")},ae=e=>{T.value=e,e?console.log("选择分组:",e):O()},oe=e=>{me.success("分组创建成功"),a.fetchQuestionGroups()},ne=e=>{me.success("分组更新成功"),a.fetchQuestionGroups()},ie=e=>{me.success("分组删除成功"),T.value===e&&(T.value="",O())},de=e=>{B.value=e?o.value.map(e=>e.id):[]},ce=()=>{B.value=[]},re=e=>u(null,null,function*(){try{for(const l of e)yield a.deleteQuestion(l);me.success("批量删除成功"),B.value=[],O()}catch(l){me.error("批量删除失败")}}),ve=()=>{me.success("批量修改成功"),B.value=[],O()},pe=()=>{me.success("移动成功"),B.value=[],O()},ye=()=>{me.success("导出任务已开始"),B.value=[]},ge=e=>{switch(e){case"single":return"primary";case"multiple":return"success";case"judge":return"warning";case"fill":default:return"info";case"essay":return"danger"}},we=e=>{switch(e){case"single":return"单选题";case"multiple":return"多选题";case"judge":return"判断题";case"fill":return"填空题";case"essay":return"简答题";default:return"未知"}},xe=e=>{switch(e){case"easy":return"success";case"medium":return"warning";case"hard":return"danger";default:return"info"}},qe=e=>{switch(e){case"easy":return"简单";case"medium":return"中等";case"hard":return"困难";default:return"未知"}};return(e,l)=>{const t=te,n=se,i=_e,y=Ve,Q=ke,j=Ce,I=be,z=ue,E=he;return f(),d("div",Ol,[v(We),c("div",Pl,[c("div",Rl,[v(ol,{"selected-type":A.value,onTypeSelect:N,onCreateGroup:le},null,8,["selected-type"]),c("div",Fl,[v(Cl,{"selected-group-id":T.value,onGroupSelect:ae,onGroupCreated:oe,onGroupUpdated:ne,onGroupDeleted:ie},null,8,["selected-group-id"])])]),c("div",Ml,[c("div",Wl,[l[8]||(l[8]=c("div",{class:"header-content"},[c("h1",{class:"page-title"},"题库管理"),c("p",{class:"page-description"},"管理您的所有题目，生成和编辑练习题目")],-1)),c("div",Ll,[v(t,{type:"primary",onClick:W},{default:h(()=>[v(p(G),{icon:["fas","plus"],class:"mr-2"}),l[7]||(l[7]=V(" 生成题目 ",-1))]),_:1})])]),v(El,{modelValue:D.value,"onUpdate:modelValue":l[0]||(l[0]=e=>D.value=e),onSearch:R},null,8,["modelValue"]),B.value.length>0?(f(),g(rl,{key:0,"selected-questions":B.value,"total-questions":b.value,onSelectAll:de,onBatchDelete:re,onBatchModify:ve,onBatchMove:pe,onBatchExport:ye,onClearSelection:ce},null,8,["selected-questions","total-questions"])):r("",!0),x((f(),d("div",$l,[0!==o.value.length||s.value?r("",!0):(f(),d("div",Kl,[c("div",Nl,[v(p(G),{icon:["fas","question-circle"]})]),l[10]||(l[10]=c("h3",null,"暂无题目",-1)),l[11]||(l[11]=c("p",null,"开始生成您的第一道题目吧！",-1)),v(t,{type:"primary",onClick:W},{default:h(()=>[v(p(G),{icon:["fas","plus"],class:"mr-2"}),l[9]||(l[9]=V(" 生成题目 ",-1))]),_:1})])),(f(!0),d(_,null,k(o.value,e=>{return f(),d("div",{key:e.id,class:"question-card"},[c("div",Jl,[c("div",Xl,[v(n,{"model-value":B.value.includes(e.id),onChange:l=>(e=>{const l=B.value.indexOf(e);l>-1?B.value.splice(l,1):B.value.push(e)})(e.id)},null,8,["model-value","onChange"])]),c("div",Yl,[v(i,{type:ge(e.type)},{default:h(()=>[V(m(we(e.type)),1)]),_:2},1032,["type"]),v(i,{type:xe(e.difficulty),size:"small"},{default:h(()=>[V(m(qe(e.difficulty)),1)]),_:2},1032,["type"]),e.tags&&e.tags.length>0?(f(),g(i,{key:0,size:"small",type:"info"},{default:h(()=>[V(m(e.tags[0]),1)]),_:2},1024)):r("",!0)]),c("div",Hl,[v(j,{trigger:"click",onClick:l[1]||(l[1]=C(()=>{},["stop"]))},{dropdown:h(()=>[v(Q,null,{default:h(()=>[v(y,{onClick:l=>L(e.id)},{default:h(()=>[v(p(G),{icon:["fas","edit"],class:"mr-2"}),l[12]||(l[12]=V(" 编辑题目 ",-1))]),_:1},8,["onClick"]),v(y,{onClick:l=>(e=>{S.value=e,U.value=!0})(e)},{default:h(()=>[v(p(G),{icon:["fas","eye"],class:"mr-2"}),l[13]||(l[13]=V(" 预览题目 ",-1))]),_:1},8,["onClick"]),v(y,{onClick:l=>(e=>u(null,null,function*(){try{yield fe.confirm("确定要删除这道题目吗？此操作不可撤销。","删除确认",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),yield a.deleteQuestion(e.id),me.success("题目删除成功"),O()}catch(l){"cancel"!==l&&(console.error("删除题目失败:",l),me.error("删除题目失败"))}}))(e),divided:""},{default:h(()=>[v(p(G),{icon:["fas","trash"],class:"mr-2"}),l[14]||(l[14]=V(" 删除题目 ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),default:h(()=>[v(t,{type:"text",size:"small"},{default:h(()=>[v(p(G),{icon:["fas","ellipsis-v"]})]),_:1})]),_:2},1024)])]),c("div",Zl,[c("div",ea,m(e.content),1),e.options&&e.options.length>0?(f(),d("div",la,[(f(!0),d(_,null,k(e.options,(e,l)=>(f(),d("div",{key:l,class:"option-item"},[c("span",aa,m(String.fromCharCode(65+l))+".",1),c("span",ta,m(e),1)]))),128))])):r("",!0)]),c("div",sa,[c("div",ua,[c("span",oa,[v(p(G),{icon:["fas","chart-line"]}),V(" "+m(e.correctCount||0)+"/"+m(e.totalCount||0),1)]),c("span",na,[v(p(G),{icon:["fas","clock"]}),V(" "+m((s=e.createdAt,new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"}))),1)])])])]);var s}),128))])),[[E,s.value]]),b.value>0?(f(),d("div",ia,[v(I,{"current-page":w.value,"onUpdate:currentPage":l[2]||(l[2]=e=>w.value=e),"page-size":q.value,"onUpdate:pageSize":l[3]||(l[3]=e=>q.value=e),total:b.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:M},null,8,["current-page","page-size","total"])])):r("",!0)])]),v(z,{modelValue:U.value,"onUpdate:modelValue":l[6]||(l[6]=e=>U.value=e),title:"题目预览",width:"600px","close-on-click-modal":!1},{footer:h(()=>[v(t,{onClick:l[4]||(l[4]=e=>U.value=!1)},{default:h(()=>[...l[19]||(l[19]=[V("关闭",-1)])]),_:1}),v(t,{type:"primary",onClick:l[5]||(l[5]=e=>S.value&&L(S.value.id))},{default:h(()=>[...l[20]||(l[20]=[V(" 编辑题目 ",-1)])]),_:1})]),default:h(()=>[S.value?(f(),d("div",da,[c("div",ca,[v(i,{type:ge(S.value.type)},{default:h(()=>[V(m(we(S.value.type)),1)]),_:1},8,["type"]),v(i,{type:xe(S.value.difficulty),size:"small"},{default:h(()=>[V(m(qe(S.value.difficulty)),1)]),_:1},8,["type"])]),c("div",ra,[l[18]||(l[18]=c("h4",null,"题目内容",-1)),c("p",null,m(S.value.content),1),S.value.options&&S.value.options.length>0?(f(),d("div",va,[l[15]||(l[15]=c("h4",null,"选项",-1)),(f(!0),d(_,null,k(S.value.options,(e,l)=>(f(),d("div",{key:l,class:"option-item"},[c("span",pa,m(String.fromCharCode(65+l))+".",1),c("span",ma,m(e),1)]))),128))])):r("",!0),c("div",fa,[l[16]||(l[16]=c("h4",null,"正确答案",-1)),c("p",ya,m(S.value.answer),1)]),c("div",ga,[l[17]||(l[17]=c("h4",null,"详细解析",-1)),c("p",ha,m(S.value.explanation),1)])])])):r("",!0)]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-aa9bdceb"]]);export{ba as default};

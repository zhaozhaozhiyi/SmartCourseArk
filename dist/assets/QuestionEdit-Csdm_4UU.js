var e=(e,a,l)=>new Promise((t,s)=>{var n=e=>{try{o(l.next(e))}catch(a){s(a)}},u=e=>{try{o(l.throw(e))}catch(a){s(a)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,u);o((l=l.apply(e,a)).next())});/* empty css             *//* empty css                   *//* empty css               *//* empty css                *//* empty css                *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                  */import{y as a,r as l,j as t,aC as s,K as n,z as u,B as o,R as r,J as i,A as p,O as d,I as c,L as v,Q as m,a5 as f,u as y,a4 as h,P as g,aB as w}from"./vue-vendor-BRizdQXW.js";import{l as _,E as b,u as x,F as j}from"./index-CgjG02ur.js";import{useQuestionStore as V}from"./question-CtH6naOE.js";import{E as C,z as k,h as q,H as U,b as z,d as P,y as Q,B,e as E,C as F}from"./element-plus-1qB5igSe.js";import{_ as I}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./storage-B26rRKbu.js";import"./index-B0rpCtHA.js";const L={class:"question-edit"},R={class:"page-header"},S={class:"header-actions"},A={class:"edit-content"},D={class:"question-preview"},G={class:"preview-header"},H={class:"preview-content"},J={key:0},K={class:"option-label"},O={class:"option-text"},$={class:"answer-section"},M={class:"answer-text"},N={class:"explanation-section"},T={class:"explanation-text"},W=I(a({__name:"QuestionEdit",setup(a){_.add(b,x);const I=s(),W=w(),X=V(),Y=l(!1),Z=l(),ee=l({type:"single",content:"",options:["","","",""],answer:"",explanation:"",difficulty:"medium"}),ae={type:[{required:!0,message:"请选择题目类型",trigger:"change"}],content:[{required:!0,message:"请输入题目内容",trigger:"blur"}],answer:[{required:!0,message:"请输入正确答案",trigger:"blur"}],explanation:[{required:!0,message:"请输入详细解析",trigger:"blur"}],difficulty:[{required:!0,message:"请选择难度级别",trigger:"change"}]};t(()=>e(null,null,function*(){const e=I.params.id;e&&(yield le(e))}));const le=a=>e(null,null,function*(){try{Y.value=!0;const e=yield X.fetchQuestion(a);e&&(ee.value={type:e.type,content:e.content,options:e.options||["","","",""],answer:e.answer,explanation:e.explanation,difficulty:e.difficulty})}catch(e){console.error("获取题目信息失败:",e),C.error("获取题目信息失败")}finally{Y.value=!1}}),te=e=>{"judge"===e?(ee.value.options=[],ee.value.answer="正确"):"fill"===e||"essay"===e?ee.value.options=[]:0===ee.value.options.length&&(ee.value.options=["","","",""])},se=()=>{ee.value.options.push("")},ne=()=>e(null,null,function*(){try{if(!Z.value)return;yield Z.value.validate(),Y.value=!0;const e=I.params.id,a={type:ee.value.type,content:ee.value.content,options:ee.value.options.filter(e=>""!==e.trim()),answer:ee.value.answer,explanation:ee.value.explanation,difficulty:ee.value.difficulty};yield X.updateQuestion(e,a),C.success("题目保存成功"),W.push("/questions")}catch(e){console.error("保存题目失败:",e),C.error("保存题目失败")}finally{Y.value=!1}}),ue=()=>{W.back()},oe=e=>{switch(e){case"single":return"primary";case"multiple":return"success";case"judge":return"warning";case"fill":default:return"info";case"essay":return"danger"}},re=e=>{switch(e){case"single":return"单选题";case"multiple":return"多选题";case"judge":return"判断题";case"fill":return"填空题";case"essay":return"简答题";default:return"未知"}},ie=e=>{switch(e){case"easy":return"success";case"medium":return"warning";case"hard":return"danger";default:return"info"}},pe=e=>{switch(e){case"easy":return"简单";case"medium":return"中等";case"hard":return"困难";default:return"未知"}};return(e,a)=>{const l=q,t=B,s=Q,w=P,_=E,b=z,x=U,V=F,I=k;return n((p(),u("div",L,[o("div",R,[a[8]||(a[8]=o("div",{class:"header-content"},[o("h1",{class:"page-title"},"编辑题目"),o("p",{class:"page-description"},"编辑和优化题目内容")],-1)),o("div",S,[r(l,{onClick:ue},{default:i(()=>[...a[6]||(a[6]=[d("返回",-1)])]),_:1}),r(l,{type:"primary",onClick:ne},{default:i(()=>[...a[7]||(a[7]=[d("保存",-1)])]),_:1})])]),o("div",A,[r(x,null,{header:i(()=>[...a[9]||(a[9]=[o("h3",null,"题目信息",-1)])]),default:i(()=>[r(b,{model:ee.value,rules:ae,ref_key:"formRef",ref:Z,"label-width":"120px"},{default:i(()=>[r(w,{label:"题目类型",prop:"type"},{default:i(()=>[r(s,{modelValue:ee.value.type,"onUpdate:modelValue":a[0]||(a[0]=e=>ee.value.type=e),placeholder:"请选择题目类型",onChange:te},{default:i(()=>[r(t,{label:"单选题",value:"single"}),r(t,{label:"多选题",value:"multiple"}),r(t,{label:"判断题",value:"judge"}),r(t,{label:"填空题",value:"fill"}),r(t,{label:"简答题",value:"essay"})]),_:1},8,["modelValue"])]),_:1}),r(w,{label:"题目内容",prop:"content"},{default:i(()=>[r(_,{modelValue:ee.value.content,"onUpdate:modelValue":a[1]||(a[1]=e=>ee.value.content=e),type:"textarea",rows:4,placeholder:"请输入题目内容"},null,8,["modelValue"])]),_:1}),"single"===ee.value.type||"multiple"===ee.value.type?(p(),c(w,{key:0,label:"选项",prop:"options"},{default:i(()=>[(p(!0),u(m,null,f(ee.value.options,(e,a)=>(p(),u("div",{key:a,class:"option-item"},[r(_,{modelValue:ee.value.options[a],"onUpdate:modelValue":e=>ee.value.options[a]=e,placeholder:`选项 ${String.fromCharCode(65+a)}`},{append:i(()=>[r(l,{onClick:e=>(e=>{ee.value.options.length>2?ee.value.options.splice(e,1):C.warning("至少需要2个选项")})(a),type:"danger",plain:""},{default:i(()=>[r(y(j),{icon:["fas","trash"]})]),_:1},8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]))),128)),r(l,{onClick:se,type:"primary",plain:""},{default:i(()=>[r(y(j),{icon:["fas","plus"],class:"mr-2"}),a[10]||(a[10]=d(" 添加选项 ",-1))]),_:1})]),_:1})):v("",!0),r(w,{label:"正确答案",prop:"answer"},{default:i(()=>[r(_,{modelValue:ee.value.answer,"onUpdate:modelValue":a[3]||(a[3]=e=>ee.value.answer=e),placeholder:"请输入正确答案",type:"judge"===ee.value.type?"select":"text"},h({_:2},["judge"===ee.value.type?{name:"append",fn:i(()=>[r(s,{modelValue:ee.value.answer,"onUpdate:modelValue":a[2]||(a[2]=e=>ee.value.answer=e),placeholder:"选择答案"},{default:i(()=>[r(t,{label:"正确",value:"正确"}),r(t,{label:"错误",value:"错误"})]),_:1},8,["modelValue"])]),key:"0"}:void 0]),1032,["modelValue","type"])]),_:1}),r(w,{label:"详细解析",prop:"explanation"},{default:i(()=>[r(_,{modelValue:ee.value.explanation,"onUpdate:modelValue":a[4]||(a[4]=e=>ee.value.explanation=e),type:"textarea",rows:3,placeholder:"请输入详细解析"},null,8,["modelValue"])]),_:1}),r(w,{label:"难度级别",prop:"difficulty"},{default:i(()=>[r(s,{modelValue:ee.value.difficulty,"onUpdate:modelValue":a[5]||(a[5]=e=>ee.value.difficulty=e),placeholder:"请选择难度级别"},{default:i(()=>[r(t,{label:"简单",value:"easy"}),r(t,{label:"中等",value:"medium"}),r(t,{label:"困难",value:"hard"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),r(x,null,{header:i(()=>[...a[11]||(a[11]=[o("h3",null,"题目预览",-1)])]),default:i(()=>[o("div",D,[o("div",G,[r(V,{type:oe(ee.value.type)},{default:i(()=>[d(g(re(ee.value.type)),1)]),_:1},8,["type"]),r(V,{type:ie(ee.value.difficulty),size:"small"},{default:i(()=>[d(g(pe(ee.value.difficulty)),1)]),_:1},8,["type"])]),o("div",H,[a[15]||(a[15]=o("h4",null,"题目内容",-1)),o("p",null,g(ee.value.content||"请输入题目内容"),1),ee.value.options&&ee.value.options.length>0?(p(),u("div",J,[a[12]||(a[12]=o("h4",null,"选项",-1)),(p(!0),u(m,null,f(ee.value.options,(e,a)=>(p(),u("div",{key:a,class:"option-item"},[o("span",K,g(String.fromCharCode(65+a))+".",1),o("span",O,g(e),1)]))),128))])):v("",!0),o("div",$,[a[13]||(a[13]=o("h4",null,"正确答案",-1)),o("p",M,g(ee.value.answer||"请输入正确答案"),1)]),o("div",N,[a[14]||(a[14]=o("h4",null,"详细解析",-1)),o("p",T,g(ee.value.explanation||"请输入详细解析"),1)])])])]),_:1})])])),[[I,Y.value]])}}}),[["__scopeId","data-v-f1b495bd"]]);export{W as default};

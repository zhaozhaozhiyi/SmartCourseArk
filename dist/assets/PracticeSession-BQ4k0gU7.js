const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/question-CtH6naOE.js","assets/vue-vendor-BRizdQXW.js","assets/storage-B26rRKbu.js","assets/index-B0rpCtHA.js","assets/element-plus-1qB5igSe.js","assets/index-DslGysim.css"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,i=(l,a,s)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[a]=s,o=(e,l)=>{for(var a in l||(l={}))t.call(l,a)&&i(e,a,l[a]);if(s)for(var a of s(l))u.call(l,a)&&i(e,a,l[a]);return e},n=(e,l,a)=>new Promise((s,t)=>{var u=e=>{try{o(a.next(e))}catch(l){t(l)}},i=e=>{try{o(a.throw(e))}catch(l){t(l)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(u,i);o((a=a.apply(e,l)).next())});import{_ as r}from"./index-B0rpCtHA.js";/* empty css             *//* empty css                    *//* empty css                         *//* empty css                  *//* empty css                 *//* empty css                    *//* empty css                          *//* empty css                       *//* empty css               */import{y as c,r as v,c as d,aC as p,j as m,U as f,aB as y,z as h,B as b,L as g,P as _,E as j,R as L,J as w,u as E,A as I,O as k,Q as S,a5 as V,I as P}from"./vue-vendor-BRizdQXW.js";import{l as q,d as U,F as A}from"./index-CgjG02ur.js";import{u as x}from"./practice-6QDq9InZ.js";import{u as M}from"./course-DWSJBfyD.js";import{a as O,Q}from"./storage-B26rRKbu.js";import{E as D,F as C,C as T,U as $,W as F,e as G,h as R,S as B,V as Y,f as H}from"./element-plus-1qB5igSe.js";import{_ as J}from"./_plugin-vue_export-helper-BCo6x5W8.js";const N={class:"practice-session"},z={class:"session-header"},K={class:"header-left"},W={class:"session-subtitle"},X={class:"header-right"},Z={class:"session-info"},ee={class:"info-item"},le={class:"info-value"},ae={class:"info-item"},se={class:"info-value"},te={key:0,class:"info-item"},ue={key:0,class:"session-content"},ie={class:"question-card"},oe={class:"question-header"},ne={class:"question-number"},re={class:"question-meta"},ce={class:"question-content"},ve=["innerHTML"],de={key:0,class:"question-options"},pe={key:1,class:"question-options"},me={key:2,class:"question-options"},fe={key:3,class:"question-input"},ye={key:4,class:"question-input"},he={class:"question-actions"},be={key:1,class:"session-complete"},ge={class:"complete-card"},_e={class:"complete-icon"},je={class:"complete-stats"},Le={class:"stat-item"},we={class:"stat-value"},Ee={class:"stat-item"},Ie={class:"stat-value"},ke={class:"stat-item"},Se={class:"stat-value"},Ve={class:"stat-item"},Pe={class:"stat-value"},qe={class:"complete-actions"},Ue={key:2,class:"loading-container"},Ae=J(c({__name:"PracticeSession",setup(e){q.add(U);const s=p(),t=y(),u=x(),i=M(),c=v(!1),J=v(!1),Ae=v(null),xe=v([]),Me=v(0),Oe=v(""),Qe=v([]),De=v(""),Ce=v(""),Te=v(""),$e=v(0),Fe=v(Date.now());let Ge=null;const Re=d(()=>s.params.courseId),Be=d(()=>s.params.sessionId),Ye=d(()=>{const e=i.courses.find(e=>e.id===Re.value);return(null==e?void 0:e.title)||"未知课程"}),He=d(()=>xe.value[Me.value]||null),Je=d(()=>{var e;return"completed"===(null==(e=Ae.value)?void 0:e.status)||Me.value>=xe.value.length}),Ne=d(()=>{var e;if(!(null==(e=Ae.value)?void 0:e.timeLimit))return 0;const l=60*Ae.value.timeLimit;return Math.max(0,l-$e.value)});m(()=>n(null,null,function*(){yield ze(),We()})),f(()=>{Ge&&clearInterval(Ge)});const ze=()=>n(null,null,function*(){try{c.value=!0;const e=yield u.fetchPracticeSession(Be.value);e?(Ae.value=e,yield Ke()):(D.error("练习会话不存在"),t.push("/practice"))}catch(e){console.error("加载练习会话失败:",e),D.error("加载练习会话失败"),t.push("/practice")}finally{c.value=!1}}),Ke=()=>n(null,null,function*(){try{const{useQuestionStore:e}=yield r(()=>n(null,null,function*(){const{useQuestionStore:e}=yield import("./question-CtH6naOE.js");return{useQuestionStore:e}}),__vite__mapDeps([0,1,2,3,4,5])),l=e(),a=yield l.getRandomQuestions(Ae.value.courseId,Ae.value.totalQuestions,{types:Ae.value.questionTypes});xe.value=a,a.length<Ae.value.totalQuestions&&D.warning(`题库中符合条件的题目不足，只获取到 ${a.length} 道题目`)}catch(e){console.error("加载题目失败:",e),D.error("加载题目失败")}}),We=()=>{Ge=setInterval(()=>{var e;$e.value=Math.floor((Date.now()-Fe.value)/1e3),(null==(e=Ae.value)?void 0:e.timeLimit)&&Ne.value<=0&&sl()},1e3)},Xe=()=>n(null,null,function*(){const e=el();if(!e||Array.isArray(e)&&0===e.length)D.warning("请先选择或输入答案");else try{J.value=!0,yield u.submitAnswer(Be.value,He.value.id,e),Me.value++,Me.value>=xe.value.length?yield al():ll()}catch(l){console.error("提交答案失败:",l),D.error("提交答案失败")}finally{J.value=!1}}),Ze=()=>{Me.value++,ll(),Me.value>=xe.value.length&&al()},el=()=>{if(!He.value)return"";switch(He.value.type){case O.SINGLE:return Oe.value;case O.MULTIPLE:return Qe.value;case O.JUDGE:return De.value;case O.FILL:return Ce.value;case O.ESSAY:return Te.value;default:return""}},ll=()=>{Oe.value="",Qe.value=[],De.value="",Ce.value="",Te.value=""},al=()=>n(null,null,function*(){try{const s=yield u.completePracticeSession(Be.value);Ae.value=(e=o(o({},Ae.value),s),l(e,a({status:"completed"}))),Ge&&clearInterval(Ge),D.success("练习完成！")}catch(s){console.error("完成练习失败:",s),D.error("完成练习失败")}var e}),sl=()=>n(null,null,function*(){try{yield C.confirm("时间已到，练习将自动结束","时间到",{confirmButtonText:"确定",showCancelButton:!1,type:"warning"}),yield al()}catch(e){yield al()}}),tl=()=>{t.push(`/practice/${Re.value}/result/${Be.value}`)},ul=()=>{t.push("/practice")},il=e=>{switch(e){case Q.EASY:return"success";case Q.MEDIUM:return"warning";case Q.HARD:return"danger";default:return"info"}},ol=e=>{switch(e){case Q.EASY:return"简单";case Q.MEDIUM:return"中等";case Q.HARD:return"困难";default:return"未知"}},nl=e=>{switch(e){case O.SINGLE:return"单选题";case O.MULTIPLE:return"多选题";case O.JUDGE:return"判断题";case O.FILL:return"填空题";case O.ESSAY:return"简答题";default:return"未知类型"}},rl=e=>{if(e<60)return`${e}秒`;const l=Math.floor(e/60),a=e%60;return a>0?`${l}分${a}秒`:`${l}分钟`};return(e,l)=>{var a,s,t,u,i;const o=T,n=Y,r=$,v=H,d=F,p=G,m=R,f=B;return I(),h("div",N,[b("div",z,[b("div",K,[l[5]||(l[5]=b("h1",{class:"session-title"},"练习进行中",-1)),b("p",W,_(Ye.value),1)]),b("div",X,[b("div",Z,[b("div",ee,[l[6]||(l[6]=b("span",{class:"info-label"},"题目进度:",-1)),b("span",le,_(Me.value+1)+" / "+_(null==(a=Ae.value)?void 0:a.totalQuestions),1)]),b("div",ae,[l[7]||(l[7]=b("span",{class:"info-label"},"用时:",-1)),b("span",se,_(rl($e.value)),1)]),(null==(s=Ae.value)?void 0:s.timeLimit)?(I(),h("div",te,[l[8]||(l[8]=b("span",{class:"info-label"},"剩余时间:",-1)),b("span",{class:j(["info-value",{"time-warning":Ne.value<300}])},_(rl(Ne.value)),3)])):g("",!0)])])]),He.value?(I(),h("div",ue,[b("div",ie,[b("div",oe,[b("div",ne," 题目 "+_(Me.value+1),1),b("div",re,[L(o,{type:il(He.value.difficulty)},{default:w(()=>[k(_(ol(He.value.difficulty)),1)]),_:1},8,["type"]),L(o,{type:"info"},{default:w(()=>[k(_(nl(He.value.type)),1)]),_:1})])]),b("div",ce,[b("div",{class:"question-text",innerHTML:He.value.content},null,8,ve),He.value.type===E(O).SINGLE?(I(),h("div",de,[L(r,{modelValue:Oe.value,"onUpdate:modelValue":l[0]||(l[0]=e=>Oe.value=e)},{default:w(()=>[(I(!0),h(S,null,V(He.value.options,(e,l)=>(I(),P(n,{key:l,label:e,class:"option-item"},{default:w(()=>[k(_(e),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])):g("",!0),He.value.type===E(O).MULTIPLE?(I(),h("div",pe,[L(d,{modelValue:Qe.value,"onUpdate:modelValue":l[1]||(l[1]=e=>Qe.value=e)},{default:w(()=>[(I(!0),h(S,null,V(He.value.options,(e,l)=>(I(),P(v,{key:l,label:e,class:"option-item"},{default:w(()=>[k(_(e),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])):g("",!0),He.value.type===E(O).JUDGE?(I(),h("div",me,[L(r,{modelValue:De.value,"onUpdate:modelValue":l[2]||(l[2]=e=>De.value=e)},{default:w(()=>[L(n,{label:"正确",class:"option-item"},{default:w(()=>[...l[9]||(l[9]=[k("正确",-1)])]),_:1}),L(n,{label:"错误",class:"option-item"},{default:w(()=>[...l[10]||(l[10]=[k("错误",-1)])]),_:1})]),_:1},8,["modelValue"])])):g("",!0),He.value.type===E(O).FILL?(I(),h("div",fe,[L(p,{modelValue:Ce.value,"onUpdate:modelValue":l[3]||(l[3]=e=>Ce.value=e),placeholder:"请输入答案",clearable:""},null,8,["modelValue"])])):g("",!0),He.value.type===E(O).ESSAY?(I(),h("div",ye,[L(p,{modelValue:Te.value,"onUpdate:modelValue":l[4]||(l[4]=e=>Te.value=e),type:"textarea",rows:4,placeholder:"请输入您的答案"},null,8,["modelValue"])])):g("",!0)]),b("div",he,[L(m,{type:"primary",onClick:Xe,disabled:!el()||Array.isArray(el())&&0===el().length,loading:J.value},{default:w(()=>[...l[11]||(l[11]=[k(" 提交答案 ",-1)])]),_:1},8,["disabled","loading"]),L(m,{onClick:Ze,disabled:J.value},{default:w(()=>[...l[12]||(l[12]=[k(" 跳过此题 ",-1)])]),_:1},8,["disabled"])])])])):g("",!0),Je.value?(I(),h("div",be,[b("div",ge,[b("div",_e,[L(E(A),{icon:["fas","trophy"]})]),l[19]||(l[19]=b("h2",{class:"complete-title"},"练习完成！",-1)),l[20]||(l[20]=b("p",{class:"complete-subtitle"},"恭喜您完成了本次练习",-1)),b("div",je,[b("div",Le,[b("div",we,_(null==(t=Ae.value)?void 0:t.totalQuestions),1),l[13]||(l[13]=b("div",{class:"stat-label"},"总题数",-1))]),b("div",Ee,[b("div",Ie,_(null==(u=Ae.value)?void 0:u.correctQuestions),1),l[14]||(l[14]=b("div",{class:"stat-label"},"正确数",-1))]),b("div",ke,[b("div",Se,_(null==(i=Ae.value)?void 0:i.score)+"%",1),l[15]||(l[15]=b("div",{class:"stat-label"},"得分",-1))]),b("div",Ve,[b("div",Pe,_(rl($e.value)),1),l[16]||(l[16]=b("div",{class:"stat-label"},"用时",-1))])]),b("div",qe,[L(m,{type:"primary",onClick:tl},{default:w(()=>[...l[17]||(l[17]=[k(" 查看详细结果 ",-1)])]),_:1}),L(m,{onClick:ul},{default:w(()=>[...l[18]||(l[18]=[k(" 开始新练习 ",-1)])]),_:1})])])])):g("",!0),c.value?(I(),h("div",Ue,[L(f,{rows:5,animated:""})])):g("",!0)])}}}),[["__scopeId","data-v-ea353127"]]);export{Ae as default};
